{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","// Fonction de logging améliorée\nfunction log(message, data = null) {\n    const timestamp = new Date().toISOString();\n    const logMessage = `[${timestamp}] ${message}`;\n    \n    if (data) {\n        console.group(logMessage);\n        console.log('Détails:', data);\n        if (data instanceof Error) {\n            console.log('Stack:', data.stack);\n        }\n        console.groupEnd();\n    } else {\n        console.log(logMessage);\n    }\n}\n\n// Initialisation\nOffice.onReady((info) => {\n    log('Office.onReady appelé', info);\n    if (info.host === Office.HostType.Outlook) {\n        log('Application démarrée dans Outlook');\n        document.getElementById(\"sideload-msg\").style.display = \"none\";\n        document.getElementById(\"app-body\").style.display = \"block\";\n        \n        // Utiliser une IIFE async pour pouvoir utiliser await\n        (async () => {\n            try {\n                await loadEmailData();\n                loadUserEmailData();\n                loadSavedSettings();\n                setupPasswordToggle();\n                setupFormValidation();\n            } catch (error) {\n                log('Erreur lors du chargement initial:', error);\n            }\n        })();\n    }\n});\n\n// Chargement des données email\n// Modification de loadEmailData pour utiliser le formatage\n// Fonction pour détecter les numéros de téléphone\nconst style = document.createElement('style');\nstyle.textContent = `\n    .phone-input-container {\n        position: relative;\n        display: flex;\n        gap: 8px;\n    }\n    \n    #phone-number {\n        flex: 1;\n        padding: 8px;\n        border: 1px solid #ddd;\n        border-radius: 4px;\n    }\n    \n    #phone-select {\n        width: auto;\n        min-width: 120px;\n        padding: 8px;\n        border: 1px solid #ddd;\n        border-radius: 4px;\n        background-color: #f8f9fa;\n    }\n`;\ndocument.head.appendChild(style);\n\n\nfunction extractPhoneNumbers(text) {\n    // Fonction utilitaire pour compter les chiffres\n    function countDigits(str) {\n        return (str.match(/\\d/g) || []).length;\n    }\n\n    const phonePatterns = [\n        // Format international avec + ou 00\n        /(?:\\+|00)[1-9]\\d{1,3}[- .]?\\d(?:[- .]?\\d){4,14}/g,\n        \n        // Formats standard (minimum 6 chiffres)\n        /\\d(?:[- .]?\\d){5,14}/g\n    ];\n\n    function formatPhoneNumber(phone) {\n        // Vérifier d'abord si le numéro a au moins 6 chiffres\n        if (countDigits(phone) < 6) {\n            return null;\n        }\n\n        // Nettoyer légèrement le numéro tout en gardant le + et les espaces de formatage\n        let cleaned = phone.trim()\n            .replace(/[\\(\\)]/g, '') // Enlever les parenthèses\n            .replace(/[-\\.]/g, ' ') // Remplacer les points et tirets par des espaces\n            .replace(/\\s+/g, ' ');  // Normaliser les espaces\n\n        // Si le numéro commence par 00, le remplacer par +\n        if (cleaned.startsWith('00')) {\n            cleaned = '+' + cleaned.slice(2);\n        }\n\n        return {\n            formatted: cleaned,\n            digitCount: countDigits(cleaned)\n        };\n    }\n\n    let phones = new Map();\n\n    for (let pattern of phonePatterns) {\n        const matches = text.matchAll(pattern);\n        for (const match of matches) {\n            const phoneInfo = formatPhoneNumber(match[0]);\n            if (phoneInfo && phoneInfo.digitCount >= 6) {\n                if (!phones.has(phoneInfo.formatted)) {\n                    phones.set(phoneInfo.formatted, phoneInfo);\n                }\n            }\n        }\n    }\n\n    return Array.from(phones.values());\n}\n\nfunction populatePhoneSelect(phones) {\n    const phoneSelect = document.getElementById('phone-select');\n    const phoneInput = document.getElementById('phone-number');\n    \n    // Vider le select sauf l'option par défaut\n    while (phoneSelect.options.length > 1) {\n        phoneSelect.remove(1);\n    }\n\n    // Ajouter les numéros trouvés\n    phones.forEach((phoneInfo, index) => {\n        const option = document.createElement('option');\n        option.value = phoneInfo.formatted;\n        option.textContent = `Numéro ${index + 1}: ${phoneInfo.formatted}`;\n        phoneSelect.appendChild(option);\n    });\n\n    // Si des numéros ont été trouvés, remplir l'input avec le premier\n    if (phones.length > 0) {\n        phoneInput.value = phones[0].formatted;\n    }\n}\n\nasync function createEmailEml() {\n    try {\n        const item = Office.context.mailbox.item;\n        \n        // Récupérer les informations de base\n        const subject = item.subject || 'Sans sujet';\n        const from = item.sender.emailAddress;\n        const receivedTime = item.dateTimeCreated.toISOString();\n        \n        // Récupérer le corps du mail\n        const bodyResult = await new Promise((resolve, reject) => {\n            item.body.getAsync(Office.CoercionType.Text, (result) => {\n                if (result.status === Office.AsyncResultStatus.Succeeded) {\n                    resolve(result.value);\n                } else {\n                    reject(new Error('Échec du chargement du corps du message'));\n                }\n            });\n        });\n\n        // Construire l'en-tête EML\n        let emlContent = [\n            'From: ' + from,\n            'Subject: ' + subject,\n            'Date: ' + receivedTime,\n            'Content-Type: text/plain; charset=utf-8',\n            '',\n            bodyResult\n        ].join('\\r\\n');\n\n        // Convertir en Base64\n        const encoder = new TextEncoder();\n        const bytes = encoder.encode(emlContent);\n        const base64 = btoa(String.fromCharCode(...bytes));\n\n        // Créer un nom de fichier sécurisé\n        const safeSubject = subject.replace(/[^a-z0-9]/gi, '_').slice(0, 30);\n        const fileName = `${safeSubject}_${new Date().toISOString().slice(0, 10)}.eml`;\n\n        return {\n            name: fileName,\n            datas: base64,\n            mimetype: 'message/rfc822',\n            type: 'binary'\n        };\n\n    } catch (error) {\n        log('Erreur lors de la création de l\\'EML:', error);\n        throw error;\n    }\n}\n\nfunction displayAttachments(attachmentList) {\n    if (!attachmentList) return;\n    \n    loadAttachments(attachmentList).catch(error => {\n        console.error('Erreur lors du chargement des pièces jointes:', error);\n        showNotification('Erreur lors du chargement des pièces jointes', 'error');\n    });\n}\nfunction formatFileSize(bytes) {\n    if (bytes === 0) return '0 B';\n    const k = 1024;\n    const sizes = ['B', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n}\n\nfunction setupPhoneInputs() {\n    const phoneInput = document.getElementById('phone-number');\n    const phoneSelect = document.getElementById('phone-select');\n\n    // Gérer le changement dans le select\n    phoneSelect.addEventListener('change', (e) => {\n        if (e.target.value) {\n            phoneInput.value = e.target.value;\n        }\n    });\n\n    // Permettre la saisie libre\n    phoneInput.addEventListener('input', (e) => {\n        let value = e.target.value;\n        // Permettre +, espaces et chiffres\n        value = value.replace(/[^\\d+\\s]/g, '');\n        e.target.value = value;\n    });\n}\n\nfunction extractEmails(text) {\n    // Regex pour détecter les emails\n    const emailPattern = /[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}/g;\n    const emails = new Map();\n    \n    const matches = text.matchAll(emailPattern);\n    for (const match of matches) {\n        const email = match[0].toLowerCase().trim();\n        if (!emails.has(email)) {\n            // Vérifier si le domaine contient \"cheminees\"\n            const domain = email.split('@')[1];\n            const isPriority = !domain.includes('cheminees');\n            emails.set(email, {\n                email: email,\n                isPriority: isPriority\n            });\n        }\n    }\n    \n    // Trier les emails: prioritaires d'abord, puis par ordre alphabétique\n    return Array.from(emails.values()).sort((a, b) => {\n        if (a.isPriority !== b.isPriority) {\n            return a.isPriority ? -1 : 1;\n        }\n        return a.email.localeCompare(b.email);\n    });\n}\n\nfunction populateEmailSelect(emails) {\n    const emailSelect = document.getElementById('email-select');\n    const emailInput = document.getElementById('sender-email');\n    \n    // Vider le select sauf l'option par défaut\n    while (emailSelect.options.length > 1) {\n        emailSelect.remove(1);\n    }\n\n    // Ajouter les emails trouvés\n    emails.forEach((emailInfo, index) => {\n        const option = document.createElement('option');\n        option.value = emailInfo.email;\n        const priority = emailInfo.isPriority ? '🔵' : '⚪';\n        option.textContent = `${priority} Email ${index + 1}: ${emailInfo.email}`;\n        emailSelect.appendChild(option);\n    });\n\n    // Si des emails ont été trouvés, remplir l'input avec le premier\n    if (emails.length > 0) {\n        emailInput.value = emails[0].email;\n    }\n}\n\nfunction setupEmailInputs() {\n    const emailInput = document.getElementById('sender-email');\n    const emailSelect = document.getElementById('email-select');\n\n    // Gérer le changement dans le select\n    emailSelect.addEventListener('change', (e) => {\n        if (e.target.value) {\n            emailInput.value = e.target.value;\n        }\n    });\n\n    // Permettre la saisie libre avec validation basique d'email\n    emailInput.addEventListener('input', (e) => {\n        let value = e.target.value;\n        // Permettre caractères valides pour email\n        value = value.replace(/[^\\w@.-]/g, '');\n        e.target.value = value;\n    });\n}\n\nasync function loadAttachments(attachmentList) {\n    attachmentList.innerHTML = '';\n    console.log('Début du chargement des pièces jointes');\n    \n    const item = Office.context.mailbox.item;\n    \n    // Réinitialiser le tableau des pièces jointes\n    window.attachmentsToUpload = [];\n    let attachmentIndex = 0;\n\n    // Charger toutes les pièces jointes, y compris les inline\n    if (item.attachments) {\n        // Filtrer et traiter les pièces jointes\n        const attachments = item.attachments.filter(attachment => {\n            // Garder les pièces jointes normales et les images inline\n            return !attachment.isInline || \n                   (attachment.contentType && attachment.contentType.startsWith('image/'));\n        });\n\n        // Charger le contenu de chaque pièce jointe\n        for (const attachment of attachments) {\n            try {\n                const content = await getAttachmentContent(attachment.id);\n                let attachmentItem;\n\n                if (attachment.isInline && attachment.contentType.startsWith('image/')) {\n                    // Créer un item pour une image inline\n                    attachmentItem = createImageAttachmentItem(\n                        `data:${attachment.contentType};base64,${content}`,\n                        attachmentIndex,\n                        attachment.name\n                    );\n                    \n                    // Stocker l'image inline\n                    window.attachmentsToUpload[attachmentIndex] = {\n                        name: attachment.name,\n                        datas: content,\n                        mimetype: attachment.contentType,\n                        type: 'binary',\n                        isInline: true\n                    };\n                } else {\n                    // Créer un item pour une pièce jointe normale\n                    const attachmentData = {\n                        name: attachment.name,\n                        datas: content,\n                        mimetype: attachment.contentType || 'application/octet-stream',\n                        type: 'binary'\n                    };\n                    attachmentItem = createAttachmentItem(attachmentData, attachmentIndex);\n                    \n                    // Stocker la pièce jointe normale\n                    window.attachmentsToUpload[attachmentIndex] = attachmentData;\n                }\n\n                attachmentList.appendChild(attachmentItem);\n                attachmentIndex++;\n\n            } catch (error) {\n                console.error(`Erreur chargement pièce jointe ${attachment.name}:`, error);\n            }\n        }\n    }\n\n    // Essayer de récupérer les images du corps du mail\n    try {\n        const body = await new Promise((resolve, reject) => {\n            item.body.getAsync(\n                Office.CoercionType.Html,\n                { asyncContext: \"This is passed to the callback\" },\n                function (asyncResult) {\n                    if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {\n                        resolve(asyncResult.value);\n                    } else {\n                        reject(new Error('Échec chargement HTML'));\n                    }\n                }\n            );\n        });\n\n        const tempDiv = document.createElement('div');\n        tempDiv.innerHTML = body;\n\n        // Chercher les images qui ne sont pas des CID\n        const images = Array.from(tempDiv.getElementsByTagName('img'))\n            .filter(img => {\n                const src = img.src || img.getAttribute('src');\n                return src && \n                       !src.startsWith('cid:') && \n                       !src.startsWith('data:') && \n                       !src.includes('outlook.office365.com') && \n                       !src.includes('outlook.office.com');\n            });\n\n        // Ajouter les images trouvées\n        for (const img of images) {\n            const src = img.src || img.getAttribute('src');\n            if (src) {\n                const item = createImageAttachmentItem(\n                    src, \n                    attachmentIndex,\n                    `Image ${attachmentIndex + 1}`\n                );\n                attachmentList.appendChild(item);\n                \n                // Stocker l'URL de l'image pour l'upload ultérieur\n                window.attachmentsToUpload[attachmentIndex] = {\n                    name: `Image ${attachmentIndex + 1}.png`,\n                    src: src,\n                    type: 'image',\n                    mimetype: 'image/png'\n                };\n                \n                attachmentIndex++;\n            }\n        }\n\n    } catch (error) {\n        console.error('Erreur chargement images:', error);\n    }\n}\n\nfunction createImageAttachmentItem(src, index, name = null) {\n    const div = document.createElement('div');\n    div.className = 'attachment-item';\n    \n    const displayName = name || `Image ${index + 1}`;\n    \n    div.innerHTML = `\n        <input type=\"checkbox\" id=\"image-${index}\" data-type=\"image\" data-src=\"${src}\" checked>\n        <img src=\"${src}\" class=\"image-preview\" alt=\"Preview\" onerror=\"this.style.display='none'\">\n        <label for=\"image-${index}\">\n            ${displayName}\n            <br>\n            <small class=\"image-source\">${src.startsWith('data:') ? 'Image intégrée' : src.substring(0, 50) + '...'}</small>\n        </label>\n    `;\n\n    return div;\n}\n\nfunction createAttachmentItem(attachment, index) {\n    const div = document.createElement('div');\n    div.className = 'attachment-item';\n    \n    div.innerHTML = `\n        <input type=\"checkbox\" id=\"attachment-${index}\" data-type=\"file\" checked>\n        <label for=\"attachment-${index}\">\n            ${attachment.name}\n            <span class=\"file-type\">(${attachment.mimetype})</span>\n        </label>\n    `;\n\n    return div;\n}\n\nasync function loadEmailData() {\n    log('Chargement des données de l\\'email');\n    const item = Office.context.mailbox.item;\n    \n    if (item) {\n        setupPhoneInputs();\n\n        // Initialiser le tableau des pièces jointes avec l'EML\n        window.attachmentsToUpload = [];\n\n        try {\n            // Créer et ajouter l'EML du mail\n            const emlAttachment = await createEmailEml();\n            window.attachmentsToUpload.push(emlAttachment);\n            log('EML du mail créé et ajouté aux pièces jointes');\n        } catch (error) {\n            log('Erreur lors de la création de l\\'EML:', error);\n        }\n\n        if (item.attachments && item.attachments.length > 0) {\n            log('Nombre de pièces jointes trouvées:', item.attachments.length);\n            \n            for (const attachment of item.attachments) {\n                if (attachment.isInline) continue;\n                \n                try {\n                    updateProgress(attachment.name, 'progress', 'Récupération en cours...');\n\n                    // Utiliser l'API EWS directement\n                    const content = await getAttachmentContent(attachment.id);\n\n                    window.attachmentsToUpload.push({\n                        name: attachment.name,\n                        datas: content,\n                        mimetype: attachment.contentType || 'application/octet-stream',\n                        res_model: 'crm.lead',\n                        type: 'binary'\n                    });\n\n                    updateProgress(attachment.name, 'success');\n                    log('Pièce jointe préparée:', {\n                        name: attachment.name,\n                        type: attachment.contentType,\n                        size: attachment.size\n                    });\n                } catch (error) {\n                    log('Erreur lors du traitement de la pièce jointe:', error);\n                    updateProgress(attachment.name, 'error', error.message);\n                }\n            }\n\n            // Afficher toutes les pièces jointes, y compris l'EML\n            const attachmentsList = document.getElementById('attachments-list');\nif (attachmentsList) {\n    displayAttachments(attachmentsList);\n}\n\nlog('Pièces jointes préparées:', window.attachmentsToUpload.length);\n        } else {\n            log('Aucune pièce jointe trouvée');\n            displayAttachments([]);\n        }\n\n        // Traitement du corps du message de manière asynchrone\n        try {\n            const bodyResult = await new Promise((resolve, reject) => {\n                item.body.getAsync(Office.CoercionType.Text, (result) => {\n                    if (result.status === Office.AsyncResultStatus.Succeeded) {\n                        resolve(result);\n                    } else {\n                        reject(new Error('Échec du chargement du corps du message'));\n                    }\n                });\n            });\n\n            const fullText = bodyResult.value;\n            document.getElementById('email-body').value = fullText;\n\n            // Détecter les numéros de téléphone et emails\n            const phones = extractPhoneNumbers(fullText);\n            log('Numéros de téléphone détectés:', phones);\n            populatePhoneSelect(phones);\n\n            const emails = extractEmails(fullText);\n            log('Emails détectés:', emails);\n            populateEmailSelect(emails);\n\n        } catch (error) {\n            log('Erreur lors du chargement du corps du message:', error);\n        }\n\n        // Traitement de l'expéditeur\n        if (item.sender) {\n            let senderEmail = item.sender.emailAddress;\n            let senderName = item.sender.displayName;\n\n            senderEmail = cleanEmail(senderEmail);\n            senderName = senderName || senderEmail.split('@')[0];\n\n            document.getElementById('sender-name').value = senderName;\n            document.getElementById('sender-email').value = senderEmail;\n        }\n\n        // Chargement du sujet\n        const subject = item.subject || '';\n        document.getElementById('email-subject').value = subject;\n    }\n}\n\n\n\nfunction updateProgress(fileName, status, message = '') {\n    const progressDiv = document.getElementById('progress-container') || createProgressDiv();\n    const fileProgress = progressDiv.querySelector(`[data-file=\"${fileName}\"]`) || createFileProgress(fileName);\n\n    switch (status) {\n        case 'progress':\n            fileProgress.className = 'file-progress progress';\n            fileProgress.innerHTML = `\n                <span class=\"filename\">${fileName}</span>\n                <span class=\"status\">${message}</span>\n                <div class=\"spinner\"></div>\n            `;\n            break;\n        case 'success':\n            fileProgress.className = 'file-progress success';\n            fileProgress.innerHTML = `\n                <span class=\"filename\">${fileName}</span>\n                <span class=\"status\">Traitement terminé ✓</span>\n            `;\n            setTimeout(() => fileProgress.remove(), 3000);\n            break;\n        case 'error':\n            fileProgress.className = 'file-progress error';\n            fileProgress.innerHTML = `\n                <span class=\"filename\">${fileName}</span>\n                <span class=\"status\">Erreur: ${message}</span>\n            `;\n            break;\n    }\n}\n\nfunction createProgressDiv() {\n    const div = document.createElement('div');\n    div.id = 'progress-container';\n    div.style.cssText = `\n        position: fixed;\n        bottom: 20px;\n        right: 20px;\n        width: 300px;\n        max-height: 80vh;\n        overflow-y: auto;\n        z-index: 1000;\n    `;\n    \n    const style = document.createElement('style');\n    style.textContent = `\n        .file-progress {\n            margin: 10px;\n            padding: 10px;\n            border-radius: 4px;\n            background: #f8f9fa;\n            border: 1px solid #ddd;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        }\n        .file-progress.progress {\n            background: #e8f4f8;\n            border-color: #b8daff;\n        }\n        .file-progress.success {\n            background: #d4edda;\n            border-color: #c3e6cb;\n        }\n        .file-progress.error {\n            background: #f8d7da;\n            border-color: #f5c6cb;\n        }\n        .filename {\n            display: block;\n            font-weight: bold;\n            margin-bottom: 5px;\n            word-break: break-all;\n        }\n        .status {\n            display: block;\n            font-size: 0.9em;\n            color: #666;\n        }\n        .spinner {\n            margin-top: 5px;\n            width: 20px;\n            height: 20px;\n            border: 2px solid #ccc;\n            border-top-color: #007bff;\n            border-radius: 50%;\n            animation: spin 1s linear infinite;\n        }\n        @keyframes spin {\n            to { transform: rotate(360deg); }\n        }\n    `;\n    document.head.appendChild(style);\n    document.body.appendChild(div);\n    return div;\n}\n\nfunction createFileProgress(fileName) {\n    const div = document.createElement('div');\n    div.className = 'file-progress';\n    div.dataset.file = fileName;\n    document.getElementById('progress-container').appendChild(div);\n    return div;\n}\n\nfunction getRestToken() {\n    return new Promise((resolve, reject) => {\n        Office.context.mailbox.getCallbackTokenAsync({isRest: true}, function(result) {\n            if (result.status === Office.AsyncResultStatus.Succeeded) {\n                resolve(result.value);\n            } else {\n                reject(new Error('Impossible d\\'obtenir le token REST'));\n            }\n        });\n    });\n}\n\n// Fonction pour obtenir une pièce jointe via l'API REST\nasync function getAttachmentViaRest(token, itemId, attachmentId) {\n    const response = await fetch(\n        `https://outlook.office.com/api/v2.0/me/messages/${itemId}/attachments/${attachmentId}/$value`,\n        {\n            headers: {\n                'Authorization': `Bearer ${token}`,\n                'Content-Type': 'application/json'\n            }\n        }\n    );\n\n    if (!response.ok) {\n        throw new Error(`Erreur HTTP: ${response.status}`);\n    }\n\n    // Convertir la réponse en base64\n    const blob = await response.blob();\n    return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onloadend = () => {\n            const base64data = reader.result.split(',')[1];\n            resolve(base64data);\n        };\n        reader.onerror = reject;\n        reader.readAsDataURL(blob);\n    });\n}\n\n// Fonction pour obtenir une pièce jointe via la méthode standard\nfunction getAttachmentContent(attachmentId) {\n    return new Promise((resolve, reject) => {\n        Office.context.mailbox.item.getAttachmentContentAsync(attachmentId, (result) => {\n            if (result.status === Office.AsyncResultStatus.Succeeded) {\n                resolve(result.value.content);\n            } else {\n                reject(new Error(`Échec de récupération de la pièce jointe: ${result.error.message}`));\n            }\n        });\n    });\n}\n\n\nfunction cleanEmail(email) {\n    if (!email) return '';\n    \n    // Enlever le \"<mailto:\" et \">\" si présent\n    email = email.replace(/<mailto:/g, '').replace(/>/g, '');\n    \n    // Enlever les espaces\n    email = email.trim();\n    \n    // Si l'email est répété, prendre la première occurrence\n    if (email.includes(' ')) {\n        email = email.split(' ')[0];\n    }\n    \n    return email;\n}\n\n\nfunction getDomainFromEmail(email) {\n    return email.split('@')[1].toLowerCase();\n}\n\n\n\nfunction cleanName(name) {\n    if (!name) return '';\n    \n    // Convertir en string si ce n'est pas déjà le cas\n    name = String(name);\n    \n    // Nettoyage plus agressif\n    name = name\n        // Enlever tous les \":\" et espaces au début\n        .replace(/^[:\\s]+/, '')\n        // Enlever tous les \":\" et espaces à la fin\n        .replace(/[:\\s]+$/, '')\n        // Enlever les guillemets\n        .replace(/[\"']/g, '')\n        // Enlever les caractères spéciaux et les espaces multiples\n        .replace(/[^\\w\\sÀ-ÿ-]/g, ' ')\n        // Remplacer les espaces multiples par un seul espace\n        .replace(/\\s+/g, ' ')\n        // Nettoyer les espaces au début et à la fin\n        .trim();\n\n    // Log du résultat du nettoyage\n    log('Nettoyage du nom:', {\n        avant: String(arguments[0]),\n        après: name\n    });\n    \n    return name;\n}\n\n\nfunction parseEmailText(text) {\n    const emails = [];\n    \n    // Diviser par les marqueurs \"De :\" ou \"From :\"\n    const segments = text.split(/(?:\\r?\\n|\\r)(?:De |From :)/).filter(Boolean);\n    \n    segments.forEach(segment => {\n        const lines = segment.split(/\\r?\\n|\\r/);\n        let currentEmail = {\n            name: '',\n            from: '',\n            subject: '',\n            content: []\n        };\n        \n        let isHeader = true;\n        let contentStarted = false;\n        \n        for (let line of lines) {\n            line = line.trim();\n            \n            if (!line) continue;\n            \n            // Traitement des en-têtes\n            if (isHeader) {\n                if (line.startsWith('From:') || line.includes('<')) {\n                    const emailMatch = line.match(/<([^>]+@[^>]+)>/);\n                    if (emailMatch) {\n                        currentEmail.from = emailMatch[1];\n                        currentEmail.name = line.split('<')[0].trim();\n                    }\n                } else if (line.startsWith('Subject:') || line.startsWith('Objet:')) {\n                    currentEmail.subject = line.replace(/^(Subject:|Objet:)/, '').trim();\n                    isHeader = false;\n                } else if (line.match(/^[\\w\\s.]+@[\\w\\s.]+\\.\\w+$/)) {\n                    currentEmail.from = line;\n                } else if (!line.match(/^(À|To|Date|Envoyé|Sent):/)) {\n                    contentStarted = true;\n                    isHeader = false;\n                }\n            }\n            \n            // Contenu de l'email\n            if (!isHeader && contentStarted && !line.match(/^(De|From|À|To|Date|Envoyé|Sent):/)) {\n                currentEmail.content.push(line);\n            }\n        }\n        \n        if (currentEmail.content.length > 0) {\n            currentEmail.content = currentEmail.content.join('\\n').trim();\n            emails.push(currentEmail);\n        }\n    });\n    \n    log('Segments d\\'email analysés:', emails);\n    return emails;\n}\n\n\n\nfunction formatEmailContent(emailBody) {\n    if (!emailBody) return '';\n    \n    // Convertir les caractères encodés en HTML\n    let cleanedContent = emailBody\n        .replace(/=3D/g, '=')\n        .replace(/=C3=A9/g, 'é')\n        .replace(/=C3=A8/g, 'è')\n        .replace(/=C3=A0/g, 'à')\n        .replace(/=C3=AB/g, 'ë')\n        .replace(/=C3=BB/g, 'û')\n        .replace(/=C3=B4/g, 'ô')\n        .replace(/=C3=AE/g, 'î')\n        .replace(/=C3=A2/g, 'â')\n        .replace(/&nbsp;/g, ' ');\n\n    // Préserver les sauts de ligne spécifiques aux emails\n    cleanedContent = cleanedContent\n        // Remplacer <div><br></div> par un marqueur spécial\n        .replace(/<div><br><\\/div>|<div><br\\/><\\/div>|<br>|<br\\/>/g, '[[LINEBREAK]]')\n        // Gérer les divs avec du contenu\n        .replace(/<div>(.*?)<\\/div>/g, '$1\\n')\n        // Nettoyer les autres balises HTML\n        .replace(/<[^>]+>/g, '')\n        // Nettoyer les caractères spéciaux restants\n        .replace(/\\r\\n|\\r|\\n/g, '\\n')\n        .trim();\n\n    // Convertir les marqueurs de saut de ligne en paragraphes HTML\n    let paragraphs = cleanedContent\n        .split('[[LINEBREAK]]')\n        .map(p => p.trim())\n        .filter(p => p !== '');\n\n    // Reconstruire le HTML avec la structure appropriée\n    cleanedContent = '<div style=\"white-space: pre-line; font-family: Arial, sans-serif;\">';\n    \n    // Ajouter chaque paragraphe avec un espacement approprié\n    paragraphs.forEach((paragraph, index) => {\n        cleanedContent += `<p style=\"margin: 0; padding: 8px 0;\">${paragraph}</p>`;\n        // Ajouter un espace entre les paragraphes\n        if (index < paragraphs.length - 1) {\n            cleanedContent += '<div style=\"height: 12px;\"></div>';\n        }\n    });\n\n    cleanedContent += '</div>';\n\n    // Ajouter les notes additionnelles si présentes\n    if (cleanedContent.includes('Notes additionnelles')) {\n        cleanedContent = cleanedContent.replace(\n            /(Notes additionnelles.*?<\\/p>)/,\n            '<div style=\"margin: 30px 0;\">' +\n            '<hr style=\"border: none; border-top: 1px solid #cccccc;\">' +\n            '<h3>$1</h3>' +\n            '<hr style=\"border: none; border-top: 1px solid #cccccc;\">' +\n            '</div>'\n        );\n    }\n\n    return cleanedContent;\n}\n\nfunction loadUserEmailData() {\n    log('Chargement des données de l\\'utilisateur');\n    const userProfile = Office.context.mailbox.userProfile;\n    if (userProfile) {\n        const userEmail = userProfile.emailAddress;\n        document.getElementById('user-email').value = userEmail;\n        log('Email de l\\'utilisateur chargé:', userEmail);\n    } else {\n        log('Profil utilisateur non disponible');\n    }\n}\n\n// Modification de la fonction de chargement des réglages\nfunction loadSavedSettings() {\n    log('Chargement des réglages sauvegardés');\n    try {\n        const savedSettings = localStorage.getItem('odooSettings');\n        if (savedSettings) {\n            const settings = JSON.parse(savedSettings);\n            log('Réglages trouvés', {\n                hasUrl: !!settings.odooUrl,\n                hasDatabase: !!settings.database,\n                hasUsername: !!settings.username,\n                hasPassword: !!settings.password\n            });\n            \n            document.getElementById('odoo-url').value = settings.odooUrl || '';\n            document.getElementById('database').value = settings.database || '';\n            document.getElementById('username').value = settings.username || '';\n            document.getElementById('password').value = settings.password || '';\n        } else {\n            log('Aucun réglage sauvegardé trouvé');\n        }\n    } catch (error) {\n        log('Erreur lors du chargement des réglages', error);\n    }\n}\n\n// Modification de la fonction de configuration du toggle password\nfunction setupPasswordToggle() {\n    const passwordInput = document.getElementById('password');\n    const toggleButton = document.getElementById('toggle-password');\n\n    if (passwordInput && toggleButton) {\n        toggleButton.addEventListener('click', () => {\n            const type = passwordInput.type === 'password' ? 'text' : 'password';\n            passwordInput.type = type;\n            \n            // Changer l'icône\n            const icon = toggleButton.querySelector('i');\n            if (type === 'password') {\n                icon.classList.replace('ms-Icon--Hide', 'ms-Icon--RedEye');\n            } else {\n                icon.classList.replace('ms-Icon--RedEye', 'ms-Icon--Hide');\n            }\n        });\n    }\n}\n\n// Classe OdooAPI\nclass OdooAPI {\n    constructor() {\n        const settings = this.getSettings();\n        this.host = settings.odooUrl;\n        this.db = settings.database;\n        this.username = settings.username;\n        this.password = settings.password;\n        this.worker_url = 'https://royal-pond-be25.lvr-3b7.workers.dev';\n        this.maxRetries = 3;\n        this.retryDelay = 1000;\n        \n        log('OdooAPI initialisée', {\n            host: this.host,\n            database: this.db,\n            username: this.username,\n            worker_url: this.worker_url\n        });\n    }\n\n    getSettings() {\n        const savedSettings = localStorage.getItem('odooSettings');\n        if (!savedSettings) {\n            throw new Error('Aucun réglage trouvé. Veuillez configurer l\\'add-in dans les paramètres.');\n        }\n        \n        const settings = JSON.parse(savedSettings);\n        if (!settings.odooUrl || !settings.database || !settings.username || !settings.password) {\n            throw new Error('Configuration incomplète. Veuillez vérifier vos paramètres.');\n        }\n        \n        return settings;\n    }\n\n    formatOdooUrl(url) {\n        if (!url.startsWith('http://') && !url.startsWith('https://')) {\n            url = 'https://' + url;\n        }\n        return url.replace(/\\/$/, '');\n    }\n\n    async retryRequest(fn) {\n        for (let i = 0; i < this.maxRetries; i++) {\n            try {\n                return await fn();\n            } catch (error) {\n                log(`Tentative ${i + 1}/${this.maxRetries} échouée`, error);\n                if (i === this.maxRetries - 1) throw error;\n                await new Promise(r => setTimeout(r, this.retryDelay * (i + 1)));\n            }\n        }\n    }\n\n    // Dans la classe OdooAPI\n// Dans la classe OdooAPI\n// Dans la classe OdooAPI\nescapeXml(unsafe) {\n    if (typeof unsafe !== 'string') return unsafe;\n    return unsafe\n        .replace(/[<>&'\"]/g, function (c) {\n            switch (c) {\n                case '<': return '&lt;';\n                case '>': return '&gt;';\n                case '&': return '&amp;';\n                case '\\'': return '&apos;';\n                case '\"': return '&quot;';\n                default: return c;\n            }\n        })\n        .replace(/[\\x00-\\x1F\\x7F-\\x9F]/g, '') // Supprimer les caractères de contrôle\n        .trim();\n}\n\nasync createLead(emailFrom, subject, description) {\n    try {\n        const userId = await this.getUserId();\n        \n        const senderName = document.getElementById('sender-name').value.trim();\n        const phoneNumber = document.getElementById('phone-number').value.trim();\n        \n        const cleanData = {\n            name: this.escapeXml(subject || 'Nouveau lead'),\n            email_from: this.escapeXml(emailFrom),\n            description: this.escapeXml(description),\n            user_id: userId,\n            type: 'opportunity',\n            active: true,\n            company_id: 1,\n            stage_id: 16,\n            contact_name: this.escapeXml(senderName || emailFrom.split('@')[0]),\n            phone: this.escapeXml(phoneNumber)\n        };\n\n        log('Données nettoyées pour création lead:', cleanData);\n\n        // Création du lead\n        const leadResponse = await this.fetchWithTimeout(\n            `${this.worker_url}/create_lead`,\n            {\n                method: 'POST',\n                headers: this.buildHeaders(),\n                body: JSON.stringify({\n                    odoo_url: this.host,\n                    database: this.db,\n                    username: this.username,\n                    password: this.password,\n                    lead_data: cleanData\n                })\n            }\n        );\n\n        const leadResponseText = await leadResponse.text();\n        log('Réponse brute création lead:', leadResponseText);\n\n        let data;\n        try {\n            data = JSON.parse(leadResponseText);\n        } catch (e) {\n            throw new Error(`Réponse invalide du serveur: ${leadResponseText}`);\n        }\n\n        if (!data.success) {\n            throw new Error(data.error || 'Réponse serveur indique un échec');\n        }\n\n        const leadId = data.lead_id;\n\n        // Traitement simplifié des pièces jointes\n        // Dans la méthode createLead, remplacez la partie des pièces jointes par :\n// Dans createLead de la classe OdooAPI\n// Dans la classe OdooAPI, dans la méthode createLead\n// Dans la classe OdooAPI, remplacez la partie de l'upload des pièces jointes par :\n\nif (window.attachmentsToUpload && window.attachmentsToUpload.length > 0) {\n    log(`Début upload des pièces jointes (${window.attachmentsToUpload.length})`);\n    \n    // Récupérer toutes les cases cochées\n    const checkedAttachments = document.querySelectorAll('.attachment-item input[type=\"checkbox\"]:checked');\n    \n    for (const checkbox of checkedAttachments) {\n        const id = parseInt(checkbox.id.split('-')[1]);\n        const attachment = window.attachmentsToUpload[id];\n        \n        if (!attachment) {\n            console.error(`Pièce jointe non trouvée pour l'index ${id}`);\n            continue;\n        }\n\n        try {\n            log('Début upload pièce jointe:', {\n                name: attachment.name,\n                size: attachment.datas.length\n            });\n\n            // Upload en une seule fois pour tous les fichiers\n            const attachmentResponse = await this.fetchWithTimeout(\n                `${this.worker_url}/create_attachment`,\n                {\n                    method: 'POST',\n                    headers: this.buildHeaders(),\n                    body: JSON.stringify({\n                        odoo_url: this.host,\n                        database: this.db,\n                        username: this.username,\n                        password: this.password,\n                        attachment_data: {\n                            name: attachment.name,\n                            datas: attachment.datas,\n                            res_model: 'crm.lead',\n                            res_id: leadId,\n                            mimetype: attachment.mimetype,\n                            type: 'binary'\n                        }\n                    })\n                },\n                60000 // 60 secondes timeout pour les gros fichiers\n            );\n\n            const attachmentResult = await attachmentResponse.json();\n            \n            if (!attachmentResult.success) {\n                throw new Error(attachmentResult.error || 'Échec de création de la pièce jointe');\n            }\n\n            log('Pièce jointe uploadée avec succès:', {\n                name: attachment.name,\n                id: attachmentResult.attachment_id\n            });\n\n            updateProgress(attachment.name, 'success', 'Upload terminé');\n\n        } catch (error) {\n            log('Erreur upload pièce jointe:', {\n                name: attachment.name,\n                error: error.message\n            });\n            updateProgress(attachment.name, 'error', error.message);\n            throw error;\n        }\n    }\n}\n\n        return {\n            success: true,\n            leadId: leadId,\n            message: 'Lead et références des pièces jointes créés avec succès',\n            details: data\n        };\n\n    } catch (error) {\n        log('Erreur détaillée création lead:', error);\n        throw error;\n    }\n}\n\n// Dans la classe OdooAPI\nasync createAttachment(attachmentData) {\n    try {\n        // Si res_model n'est pas spécifié, utiliser crm.lead par défaut\n        const finalAttachmentData = {\n            ...attachmentData,\n            res_model: attachmentData.res_model || 'crm.lead'\n        };\n\n        log('Création pièce jointe:', {\n            model: finalAttachmentData.res_model,\n            resId: finalAttachmentData.res_id,\n            fileName: finalAttachmentData.name\n        });\n\n        const response = await this.fetchWithTimeout(\n            `${this.worker_url}/create_attachment`,\n            {\n                method: 'POST',\n                headers: this.buildHeaders(),\n                body: JSON.stringify({\n                    odoo_url: this.host,\n                    database: this.db,\n                    username: this.username,\n                    password: this.password,\n                    attachment_data: finalAttachmentData\n                })\n            },\n            60000 // 60 secondes timeout pour les gros fichiers\n        );\n\n        const data = await response.json();\n        if (!data.success) {\n            throw new Error(data.error || 'Échec de création de la pièce jointe');\n        }\n\n        log('Pièce jointe créée avec succès:', {\n            attachmentId: data.attachment_id,\n            model: finalAttachmentData.res_model,\n            resId: finalAttachmentData.res_id\n        });\n\n        return {\n            success: true,\n            attachment_id: data.attachment_id\n        };\n    } catch (error) {\n        log('Erreur création pièce jointe:', error);\n        throw error;\n    }\n}\n\n\nasync getUserId() {\n    try {\n        const response = await this.fetchWithTimeout(\n            `${this.worker_url}/get_user_id`,\n            {\n                method: 'POST',\n                headers: this.buildHeaders(),\n                body: JSON.stringify({\n                    odoo_url: this.host,\n                    database: this.db,\n                    username: this.username,\n                    password: this.password\n                })\n            }\n        );\n\n        if (!response.ok) {\n            throw new Error(`Erreur HTTP ${response.status}`);\n        }\n\n        const data = await response.json();\n        if (!data.success || !data.user_id) {\n            throw new Error('Impossible de récupérer l\\'ID utilisateur');\n        }\n\n        return data.user_id;\n    } catch (error) {\n        throw new Error(`Erreur lors de la récupération de l'ID utilisateur: ${error.message}`);\n    }\n}\n\nasync uploadLargeAttachment(leadId, attachment) {\n    const CHUNK_SIZE = 500 * 1024; // 500KB par chunk\n    const totalChunks = Math.ceil(attachment.datas.length / CHUNK_SIZE);\n    let attachmentId = null;\n\n    log(`Début upload par chunks pour ${attachment.name}`, {\n        totalSize: attachment.datas.length,\n        chunks: totalChunks\n    });\n\n    for (let i = 0; i < totalChunks; i++) {\n        const start = i * CHUNK_SIZE;\n        const end = Math.min(start + CHUNK_SIZE, attachment.datas.length);\n        const chunk = attachment.datas.slice(start, end);\n        const isLastChunk = i === totalChunks - 1;\n\n        try {\n            const chunkResponse = await this.fetchWithTimeout(\n                `${this.worker_url}/upload_attachment_chunk`,\n                {\n                    method: 'POST',\n                    headers: this.buildHeaders(),\n                    body: JSON.stringify({\n                        odoo_url: this.host,\n                        database: this.db,\n                        username: this.username,\n                        password: this.password,\n                        attachment_data: {\n                            name: attachment.name,\n                            datas: chunk,\n                            res_model: 'crm.lead',\n                            res_id: leadId,\n                            mimetype: attachment.mimetype,\n                            chunk_index: i,\n                            total_chunks: totalChunks,\n                            is_last_chunk: isLastChunk,\n                            attachment_id: attachmentId // null pour le premier chunk\n                        }\n                    })\n                },\n                15000 // 15 secondes par chunk\n            );\n\n            const result = await chunkResponse.json();\n            \n            if (!result.success) {\n                throw new Error(result.error || 'Échec upload chunk');\n            }\n\n            // Récupérer l'ID de l'attachment après le premier chunk\n            if (i === 0) {\n                attachmentId = result.attachment_id;\n            }\n\n            updateProgress(attachment.name, 'progress', `Upload en cours... ${Math.round((i + 1) / totalChunks * 100)}%`);\n\n        } catch (error) {\n            throw new Error(`Erreur chunk ${i + 1}/${totalChunks}: ${error.message}`);\n        }\n    }\n\n    return attachmentId;\n}\n\n\n    async testServerConnection() {\n        log('Test de connexion au serveur', {\n            url: this.worker_url,\n            odoo_url: this.host\n        });\n\n        return this.retryRequest(async () => {\n            try {\n                const response = await this.fetchWithTimeout(\n                    `${this.worker_url}/test`,\n                    {\n                        method: 'POST',\n                        headers: this.buildHeaders(),\n                        body: JSON.stringify({\n                            odoo_url: this.host,\n                            database: this.db,\n                            username: this.username,\n                            password: this.password\n                        })\n                    }\n                );\n\n                if (!response.ok) {\n                    const errorData = await response.json().catch(() => ({}));\n                    throw new Error(errorData.error || `Erreur HTTP ${response.status}`);\n                }\n\n                const data = await response.json();\n                log('Réponse du test de connexion', data);\n\n                // Vérification de l'authentification\n                const loginSuccess = data.details?.login_response?.includes('<value><int>') ||\n                                   data.details?.login_response?.includes('<value><boolean>1</boolean>');\n\n                if (!loginSuccess) {\n                    throw new Error('Échec de l\\'authentification. Vérifiez vos identifiants de connexion.');\n                }\n\n                const versionInfo = this.extractVersionInfo(data.details.version_response);\n                \n                return {\n                    success: true,\n                    message: `Connexion établie avec succès (Odoo ${versionInfo.version})`,\n                    details: {\n                        version: versionInfo,\n                        responses: data.details\n                    }\n                };\n\n            } catch (error) {\n                return this.handleError(error, 'Erreur lors du test de connexion');\n            }\n        });\n    }\n\n    // Ajouter dans la classe OdooAPI\nasync searchPartners(searchCriteria) {\n    try {\n        const response = await this.fetchWithTimeout(\n            `${this.worker_url}/search_partners`,\n            {\n                method: 'POST',\n                headers: this.buildHeaders(),\n                body: JSON.stringify({\n                    odoo_url: this.host,\n                    database: this.db,\n                    username: this.username,\n                    password: this.password,\n                    search_criteria: searchCriteria\n                })\n            }\n        );\n\n        const data = await response.json();\n        if (!data.success) {\n            throw new Error(data.error || 'Échec de la recherche');\n        }\n\n        return data.partners;\n    } catch (error) {\n        log('Erreur recherche partenaires:', error);\n        throw error;\n    }\n}\n\n    extractVersionInfo(xmlResponse) {\n        try {\n            const versionMatch = xmlResponse.match(/<name>server_version<\\/name>\\s*<value><string>(.*?)<\\/string><\\/value>/);\n            const versionInfo = versionMatch ? versionMatch[1] : 'Version inconnue';\n            \n            const serieMatch = xmlResponse.match(/<name>server_serie<\\/name>\\s*<value><string>(.*?)<\\/string><\\/value>/);\n            const serie = serieMatch ? serieMatch[1] : '';\n            \n            return {\n                version: versionInfo,\n                serie: serie\n            };\n        } catch (error) {\n            log('Erreur extraction version', error);\n            return {\n                version: 'Version inconnue',\n                serie: 'Inconnue'\n            };\n        }\n    }\n\n    validateCredentials() {\n        if (!this.host || !this.db || !this.password) {\n            throw new Error('Configuration incomplète: tous les paramètres de connexion sont requis');\n        }\n    }\n\n    async init() {\n        try {\n            this.validateCredentials();\n            this.host = this.formatOdooUrl(this.host);\n            const testResult = await this.testServerConnection();\n            \n            if (!testResult.success) {\n                throw new Error(`Échec de l'initialisation: ${testResult.message}`);\n            }\n            \n            log('Initialisation réussie', testResult);\n            return testResult;\n            \n        } catch (error) {\n            log('Erreur lors de l\\'initialisation', error);\n            throw error;\n        }\n    }\n\n    buildHeaders() {\n        return {\n            'Content-Type': 'application/json',\n            'X-Api-Key': this.password\n        };\n    }\n\n    async fetchWithTimeout(url, options, timeout = 30000) { // Augmenté à 30 secondes par défaut\n        const controller = new AbortController();\n        const id = setTimeout(() => controller.abort(), timeout);\n        \n        try {\n            const response = await fetch(url, {\n                ...options,\n                signal: controller.signal\n            });\n            clearTimeout(id);\n            return response;\n        } catch (error) {\n            clearTimeout(id);\n            if (error.name === 'AbortError') {\n                throw new Error('La requête a pris trop de temps');\n            }\n            throw error;\n        }\n    }\n\n    handleError(error, customMessage = 'Une erreur est survenue') {\n        log('Erreur API', error);\n        return {\n            success: false,\n            message: error.message || customMessage,\n            details: {\n                error: error.message,\n                type: error.name\n            }\n        };\n    }\n}\n\nfunction showNotification(message, type = \"info\", details = null) {\n    const notification = document.createElement('div');\n    notification.className = `notification ${type}`;\n    \n    const messageEl = document.createElement('div');\n    messageEl.className = 'notification-message';\n    messageEl.textContent = message;\n    notification.appendChild(messageEl);\n\n    // Ajout du lien vers l'opportunité si c'est une création réussie\n    if (type === 'success' && details && details.leadId) {\n        const settings = JSON.parse(localStorage.getItem('odooSettings'));\n        const opportunityLink = document.createElement('a');\n        opportunityLink.href = `${settings.odooUrl}/web#id=${details.leadId}&model=crm.lead&view_type=form`;\n        opportunityLink.target = \"_blank\";\n        opportunityLink.className = 'opportunity-link';\n        opportunityLink.textContent = \"Voir l'opportunité dans Odoo\";\n        notification.appendChild(opportunityLink);\n    }\n\n    if (details) {\n        const detailsEl = document.createElement('div');\n        detailsEl.className = 'notification-details';\n        \n        if (details.message) {\n            const errorMessage = document.createElement('div');\n            errorMessage.className = 'error-message';\n            errorMessage.textContent = `Message: ${details.message}`;\n            detailsEl.appendChild(errorMessage);\n        }\n\n        if (details.logs && details.logs.length > 0) {\n            const logsEl = document.createElement('div');\n            logsEl.className = 'error-logs';\n            details.logs.forEach(log => {\n                const logEntry = document.createElement('div');\n                logEntry.className = 'log-entry';\n                logEntry.textContent = `${log.timestamp || ''} ${log.message || log}`;\n                logsEl.appendChild(logEntry);\n            });\n            detailsEl.appendChild(logsEl);\n        }\n\n        if (details.stack) {\n            const stackEl = document.createElement('pre');\n            stackEl.className = 'error-stack';\n            stackEl.textContent = details.stack;\n            detailsEl.appendChild(stackEl);\n        }\n\n        notification.appendChild(detailsEl);\n    }\n\n    // Styles mis à jour\n    const style = document.createElement('style');\n    style.textContent = `\n        .notification {\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            max-width: 80vw;\n            max-height: 80vh;\n            overflow-y: auto;\n            padding: 15px;\n            background: white;\n            border-radius: 5px;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n            z-index: 1000;\n            font-family: monospace;\n        }\n        .notification.error { border-left: 4px solid #f44336; }\n        .notification.success { border-left: 4px solid #4CAF50; }\n        .notification-message {\n            font-weight: bold;\n            margin-bottom: 10px;\n        }\n        .opportunity-link {\n            display: block;\n            margin: 10px 0;\n            padding: 8px 12px;\n            background-color: #4CAF50;\n            color: white;\n            text-decoration: none;\n            border-radius: 4px;\n            text-align: center;\n            font-weight: bold;\n            transition: background-color 0.3s;\n        }\n        .opportunity-link:hover {\n            background-color: #45a049;\n        }\n        .notification-details {\n            font-size: 12px;\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid #eee;\n        }\n        .error-message {\n            color: #f44336;\n            margin-bottom: 5px;\n        }\n        .error-logs {\n            margin-top: 5px;\n            padding: 5px;\n            background: #f5f5f5;\n            border-radius: 3px;\n        }\n        .log-entry {\n            padding: 2px 5px;\n            border-bottom: 1px solid #eee;\n        }\n        .error-stack {\n            margin-top: 5px;\n            padding: 5px;\n            background: #f5f5f5;\n            overflow-x: auto;\n            font-size: 11px;\n        }\n    `;\n    document.head.appendChild(style);\n    \n    document.body.appendChild(notification);\n    \n    setTimeout(() => {\n        notification.remove();\n    }, 30000);\n}\n\ndocument.getElementById('test-connection').onclick = async function() {\n    const button = this;\n    const icon = button.querySelector('i');\n    \n    let url = document.getElementById('odoo-url').value.trim();\n    const database = document.getElementById('database').value.trim();\n    const username = document.getElementById('username').value.trim();\n    const password = document.getElementById('password').value.trim();\n\n    log('Test de connexion initié', {\n        url: url,\n        database: database,\n        username: username,\n        hasPassword: !!password\n    });\n\n    if (!url || !database || !username || !password) {\n        showNotification('Veuillez remplir tous les champs', 'error');\n        return;\n    }\n\n    button.disabled = true;\n    // Sauvegarder le texte original\n    const originalText = button.textContent;\n    button.innerHTML = '<i class=\"ms-Icon ms-Icon--Sync\"></i>Test en cours...';\n\n    try {\n        // Sauvegarde d'abord les paramètres\n        const settings = {\n            odooUrl: url,\n            database,\n            username,\n            password\n        };\n        localStorage.setItem('odooSettings', JSON.stringify(settings));\n\n        // Crée ensuite l'instance de OdooAPI qui utilisera ces paramètres\n        const odoo = new OdooAPI();\n        const serverTest = await odoo.testServerConnection();\n        \n        if (serverTest.success) {\n            showNotification(\n                serverTest.message,\n                'success',\n                serverTest.details\n            );\n        } else {\n            throw new Error(serverTest.message);\n        }\n    } catch (error) {\n        log('Erreur critique', error);\n        showNotification(error.message, 'error', {\n            'Type d\\'erreur': error.name,\n            'Détails': error.stack || error.message\n        });\n    } finally {\n        button.disabled = false;\n        button.innerHTML = '<i class=\"ms-Icon ms-Icon--PlugConnected\"></i>Tester la connexion';\n    }\n};\n\n// Remplacer les gestionnaires de navigation existants par\n// Ajouter ces gestionnaires d'événements\n\n\ndocument.getElementById('settings-button').addEventListener('click', () => {\n    switchPage('settings-page');\n    document.getElementById('back-button').classList.add('visible');\n});\n\ndocument.getElementById('back-button').addEventListener('click', () => {\n    switchPage('app-body');\n    document.getElementById('back-button').classList.remove('visible');\n});\n\n// Modifier la fonction switchPage pour inclure la page de recherche\nfunction switchPage(pageId) {\n    const mainPage = document.getElementById('app-body');\n    const settingsPage = document.getElementById('settings-page');\n    const searchPage = document.getElementById('search-page');\n    \n    // Reset all pages\n    mainPage.classList.remove('slide-left');\n    settingsPage.classList.remove('active');\n    searchPage.classList.remove('active');\n    \n    switch(pageId) {\n        case 'settings-page':\n            mainPage.classList.add('slide-left');\n            settingsPage.classList.add('active');\n            break;\n        case 'search-page':\n            mainPage.classList.add('slide-left');\n            searchPage.classList.add('active');\n            break;\n        default:\n            // Retour à la page principale\n            break;\n    }\n}\n\ndocument.getElementById('search-button').addEventListener('click', async () => {\n    try {\n        // Basculer vers la page de recherche\n        switchPage('search-page');\n        document.getElementById('back-button').classList.add('visible');\n        \n        const item = Office.context.mailbox.item;\n        \n        if (item) {\n            // Traitement de l'expéditeur (même logique que loadEmailData)\n            if (item.sender) {\n                let senderEmail = item.sender.emailAddress;\n                senderEmail = cleanEmail(senderEmail);\n                document.getElementById('search-sender-email').value = senderEmail;\n            }\n\n            // Traitement du corps du message de manière asynchrone\n            try {\n                const bodyResult = await new Promise((resolve, reject) => {\n                    item.body.getAsync(Office.CoercionType.Text, (result) => {\n                        if (result.status === Office.AsyncResultStatus.Succeeded) {\n                            resolve(result);\n                        } else {\n                            reject(new Error('Échec du chargement du corps du message'));\n                        }\n                    });\n                });\n\n                const fullText = bodyResult.value;\n\n                // Détecter les numéros de téléphone (même logique que loadEmailData)\n                const phones = extractPhoneNumbers(fullText);\n                log('Numéros de téléphone détectés pour la recherche:', phones);\n                \n                // Mettre à jour le select des numéros de téléphone\n                const phoneSelect = document.getElementById('search-phone-select');\n                \n                // Vider le select sauf l'option par défaut\n                while (phoneSelect.options.length > 1) {\n                    phoneSelect.remove(1);\n                }\n\n                // Ajouter les numéros trouvés\n                phones.forEach((phoneInfo, index) => {\n                    const option = document.createElement('option');\n                    option.value = phoneInfo.formatted;\n                    option.textContent = `Numéro ${index + 1}: ${phoneInfo.formatted}`;\n                    phoneSelect.appendChild(option);\n                });\n\n                // Si des numéros ont été trouvés, remplir l'input avec le premier\n                if (phones.length > 0) {\n                    document.getElementById('search-phone-number').value = phones[0].formatted;\n                }\n\n            } catch (error) {\n                log('Erreur lors du chargement du corps du message:', error);\n                throw error;\n            }\n        }\n\n    } catch (error) {\n        console.error('Erreur lors du chargement des données:', error);\n        showNotification('Erreur lors du chargement des données', 'error', {\n            message: error.message\n        });\n    }\n});\n\n// Ajouter l'événement pour le select de téléphone dans la page de recherche\ndocument.getElementById('search-phone-select').addEventListener('change', (e) => {\n    if (e.target.value) {\n        document.getElementById('search-phone-number').value = e.target.value;\n    }\n});\n\ndocument.getElementById('search-contact-btn').addEventListener('click', async () => {\n    const button = document.getElementById('search-contact-btn');\n    const resultsContainer = document.getElementById('search-results');\n    \n    try {\n        button.disabled = true;\n        button.innerHTML = '<i class=\"ms-Icon ms-Icon--Sync\"></i>Recherche en cours...';\n        \n        const emailChecked = document.getElementById('search-email-checkbox').checked;\n        const phoneChecked = document.getElementById('search-phone-checkbox').checked;\n        \n        const searchCriteria = {};\n        \n        if (emailChecked) {\n            const email = document.getElementById('search-sender-email').value.trim();\n            if (email) searchCriteria.email = email;\n        }\n        \n        if (phoneChecked) {\n            let phone = document.getElementById('search-phone-number').value.trim();\n            phone = phone.replace(/[^0-9+]/g, '');\n            if (phone) searchCriteria.phone = phone;\n        }\n        \n        if (Object.keys(searchCriteria).length === 0) {\n            showNotification('Veuillez sélectionner et remplir au moins un critère de recherche', 'error');\n            return;\n        }\n\n        const odoo = new OdooAPI();\n        const partners = await odoo.searchPartners(searchCriteria);\n        \n        resultsContainer.innerHTML = '';\n        \n        if (partners.length === 0) {\n            resultsContainer.innerHTML = `\n                <div class=\"no-results\">\n                    Aucun contact trouvé avec ces critères\n                </div>\n            `;\n        } else {\n            const cardsContainer = document.createElement('div');\n            cardsContainer.className = 'partner-cards';\n            \n            partners.forEach(partner => {\n                const card = document.createElement('div');\n                card.className = 'partner-card';\n                \n                card.innerHTML = `\n                    <div class=\"card-header\">\n                        <input type=\"checkbox\" class=\"partner-select\" data-partner-id=\"${partner.id}\">\n                        <h3 class=\"partner-name\">${partner.name}</h3>\n                    </div>\n                    <div class=\"card-content\">\n                        <p class=\"partner-street\">${partner.street || ''}</p>\n                        <p class=\"partner-city\">${partner.zip || ''} ${partner.city || ''}</p>\n                    </div>\n                    <div class=\"card-footer\">\n                        <a href=\"${odoo.host}/web#id=${partner.id}&model=res.partner&view_type=form\" \n                           target=\"_blank\" \n                           class=\"view-button\">\n                           Voir dans Odoo\n                        </a>\n                        <button class=\"upload-button\" style=\"display: none;\" data-partner-id=\"${partner.id}\">\n                            <i class=\"ms-Icon ms-Icon--Upload\"></i> Upload\n                        </button>\n                    </div>\n                `;\n                \n                cardsContainer.appendChild(card);\n            });\n            \n            resultsContainer.appendChild(cardsContainer);\n            \n            // Gérer l'affichage du bouton d'upload et ajouter les event listeners\n            document.querySelectorAll('.partner-select').forEach(checkbox => {\n                checkbox.addEventListener('change', function() {\n                    const card = this.closest('.partner-card');\n                    const uploadButton = card.querySelector('.upload-button');\n                    uploadButton.style.display = this.checked ? 'block' : 'none';\n                });\n            });\n\n            // Ajouter les event listeners pour les boutons d'upload\n            document.querySelectorAll('.upload-button').forEach(button => {\n                button.addEventListener('click', async function() {\n                    const partnerId = this.dataset.partnerId;\n                    const originalText = this.innerHTML;\n                    \n                    try {\n                        this.disabled = true;\n                        this.innerHTML = '<i class=\"ms-Icon ms-Icon--Sync\"></i> Upload en cours...';\n                        \n                        // Vérifier si des pièces jointes sont disponibles\n                        if (!window.attachmentsToUpload || window.attachmentsToUpload.length === 0) {\n                            showNotification('Aucune pièce jointe à uploader', 'error');\n                            return;\n                        }\n                        \n                        const odoo = new OdooAPI();\n                        \n                        // Upload chaque pièce jointe\n                        for (const attachment of window.attachmentsToUpload) {\n                            try {\n                                // Modifier les données de la pièce jointe pour le partenaire\n                                // On spécifie explicitement res.partner comme res_model\nconst attachmentData = {\n    ...attachment,\n    res_model: 'res.partner',\n    res_id: parseInt(partnerId)\n};\n\n                                \n                                updateProgress(attachment.name, 'progress', 'Upload en cours...');\n                                \n                                const response = await odoo.createAttachment(attachmentData);\n                                \n                                if (response.success) {\n                                    updateProgress(attachment.name, 'success', 'Upload terminé');\n                                } else {\n                                    throw new Error(response.error || 'Échec de l\\'upload');\n                                }\n                                \n                            } catch (error) {\n                                updateProgress(attachment.name, 'error', error.message);\n                                throw error;\n                            }\n                        }\n                        \n                        showNotification('Pièces jointes uploadées avec succès', 'success');\n                        \n                        // Décocher la case après un upload réussi\n                        const card = this.closest('.partner-card');\n                        const checkbox = card.querySelector('.partner-select');\n                        checkbox.checked = false;\n                        this.style.display = 'none';\n                        \n                    } catch (error) {\n                        showNotification('Erreur lors de l\\'upload des pièces jointes', 'error', {\n                            message: error.message\n                        });\n                    } finally {\n                        this.disabled = false;\n                        this.innerHTML = originalText;\n                    }\n                });\n            });\n        }\n        \n    } catch (error) {\n        showNotification('Erreur lors de la recherche', 'error', {\n            message: error.message\n        });\n    } finally {\n        button.disabled = false;\n        button.innerHTML = '<i class=\"ms-Icon ms-Icon--Search\"></i>Chercher le contact';\n    }\n});\n\n\ndocument.getElementById('save-to-crm').onclick = async function() {\n    const button = this;\n    const originalText = button.innerHTML;\n\n    try {\n        button.disabled = true;\n        button.innerHTML = '<i class=\"ms-Icon ms-Icon--Sync\"></i>Création en cours...';\n\n        const emailFrom = document.getElementById('sender-email').value.trim();\n        const senderName = document.getElementById('sender-name').value.trim();\n        const subject = document.getElementById('email-subject').value.trim();\n        const emailBody = document.getElementById('email-body').value;\n        const additionalNotes = document.getElementById('additional-notes').value.trim();\n\n        if (!emailFrom || !subject) {\n            throw new Error('L\\'email de l\\'expéditeur et le sujet sont requis');\n        }\n\n        const odoo = new OdooAPI();\n        \n        // Formatage du contenu pour préserver la mise en forme\n        let description = '<div style=\"font-family: Arial, sans-serif;\">';\n        description += emailBody.split('\\n').map(line => \n            `<p style=\"margin: 0 0 1em 0;\">${line.trim()}</p>`\n        ).join('');\n        description += '</div>';\n\n        if (additionalNotes) {\n            description += '<div style=\"margin: 30px 0;\">';\n            description += '<hr style=\"border: none; border-top: 1px solid #cccccc;\">';\n            description += '<h3>Notes additionnelles :</h3>';\n            description += '<hr style=\"border: none; border-top: 1px solid #cccccc;\">';\n            description += additionalNotes.split('\\n').map(line => \n                `<p style=\"margin: 0 0 1em 0;\">${line.trim()}</p>`\n            ).join('');\n            description += '</div>';\n        }\n\n        const result = await odoo.createLead(emailFrom, subject, description);\n\n        if (result.success) {\n            const settings = JSON.parse(localStorage.getItem('odooSettings'));\n            const odooUrl = settings.odooUrl;\n\n            showNotification(\n                'Lead créé avec succès dans Odoo',\n                'success',\n                {\n                    leadId: result.leadId,\n                    message: result.message,\n                    logs: result.details,\n                    odooUrl: odooUrl\n                }\n            );\n        } else {\n            throw new Error('Échec de la création du lead');\n        }\n\n    } catch (error) {\n        log('Erreur complète:', error);\n        \n        const errorDetails = {\n            message: error.message,\n            type: error.name,\n            details: error.details || {},\n            logs: error.logs || [],\n            stack: error.stack\n        };\n\n        showNotification(\n            'Erreur lors de la création du lead',\n            'error',\n            errorDetails\n        );\n\n    } finally {\n        button.disabled = false;\n        button.innerHTML = originalText;\n    }\n};\n\nfunction setupFormValidation() {\n    const requiredFields = ['sender-email', 'email-subject'];\n    const saveButton = document.getElementById('save-to-crm');\n\n    function validateForm() {\n        const isValid = requiredFields.every(fieldId => {\n            const field = document.getElementById(fieldId);\n            return field && field.value.trim() !== '';\n        });\n\n        saveButton.disabled = !isValid;\n    }\n\n    // Ajouter les écouteurs d'événements pour les champs requis\n    requiredFields.forEach(fieldId => {\n        const field = document.getElementById(fieldId);\n        if (field) {\n            field.addEventListener('input', validateForm);\n            field.addEventListener('change', validateForm);\n        }\n    });\n\n    // Validation initiale\n    validateForm();\n}\n\n// Modification du gestionnaire de sauvegarde des réglages\ndocument.getElementById('save-settings').onclick = function() {\n    const settings = {\n        odooUrl: document.getElementById('odoo-url').value.trim(),\n        database: document.getElementById('database').value.trim(),\n        username: document.getElementById('username').value.trim(),\n        password: document.getElementById('password').value.trim()\n    };\n\n    log('Sauvegarde des réglages', {\n        hasUrl: !!settings.odooUrl,\n        hasDatabase: !!settings.database,\n        hasUsername: !!settings.username,\n        hasPassword: !!settings.password\n    });\n\n    if (!settings.odooUrl || !settings.database || !settings.username || !settings.password) {\n        showNotification('Veuillez remplir tous les champs', 'error');\n        return;\n    }\n\n    try {\n        localStorage.setItem('odooSettings', JSON.stringify(settings));\n        showNotification('Réglages sauvegardés avec succès !', 'success');\n    } catch (error) {\n        log('Erreur sauvegarde réglages', error);\n        showNotification('Erreur lors de la sauvegarde des réglages', 'error');\n    }\n};","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Odoo CRM Add-in</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <div id=\\\"sideload-msg\\\"> <h2 class=\\\"ms-font-xl\\\">Veuillez charger votre add-in pour voir le contenu.</h2> </div> <nav class=\\\"nav-menu\\\"> <button id=\\\"nav-form\\\" class=\\\"nav-button nav-active\\\"> <i class=\\\"ms-Icon ms-Icon--Contact\\\" aria-hidden=\\\"true\\\"></i> Contact </button> </nav> <div class=\\\"nav-buttons\\\"> <button id=\\\"settings-button\\\" class=\\\"nav-icon-button\\\" title=\\\"Réglages\\\"> <i class=\\\"ms-Icon ms-Icon--Settings\\\"></i> </button> <button id=\\\"search-button\\\" class=\\\"nav-icon-button\\\" title=\\\"Rechercher\\\"> <i class=\\\"ms-Icon ms-Icon--Search\\\"></i> </button> <button id=\\\"back-button\\\" class=\\\"back-button\\\" title=\\\"Retour\\\"> <i class=\\\"ms-Icon ms-Icon--ChevronLeft\\\"></i> </button> </div> <div class=\\\"pages-container\\\"> <div id=\\\"app-body\\\" class=\\\"page\\\"> <div class=\\\"form-container\\\"> <div class=\\\"form-group\\\"> <label class=\\\"form-label\\\">Votre adresse email</label> <input type=\\\"email\\\" id=\\\"user-email\\\" class=\\\"form-control\\\" readonly=\\\"readonly\\\"> </div> <div class=\\\"form-group\\\"> <label for=\\\"sender-name\\\">Nom de l'expéditeur</label> <input type=\\\"text\\\" id=\\\"sender-name\\\" class=\\\"form-control\\\"/> </div> <div class=\\\"form-group\\\"> <label class=\\\"form-label\\\">Email de l'expéditeur</label> <input type=\\\"email\\\" id=\\\"sender-email\\\" class=\\\"form-control\\\" required> </div> <div class=\\\"form-group phone-input-group\\\"> <label for=\\\"phone-number\\\">Numéro de téléphone</label> <div class=\\\"phone-input-container\\\"> <input type=\\\"text\\\" id=\\\"phone-number\\\" class=\\\"form-control\\\" placeholder=\\\"Entrez un numéro\\\"/> <select id=\\\"phone-select\\\" class=\\\"form-control\\\"> <option value=\\\"\\\">Numéros détectés</option> </select> </div> </div> <div class=\\\"form-group\\\"> <label class=\\\"form-label\\\">Sujet</label> <input type=\\\"text\\\" id=\\\"email-subject\\\" class=\\\"form-control\\\" required> </div> <div class=\\\"form-group\\\"> <label class=\\\"form-label\\\">Contenu du message</label> <textarea id=\\\"email-body\\\" class=\\\"form-control\\\" rows=\\\"6\\\" readonly=\\\"readonly\\\"></textarea> </div> <div class=\\\"form-group\\\"> <label class=\\\"form-label\\\">Notes additionnelles</label> <textarea id=\\\"additional-notes\\\" class=\\\"form-control\\\" rows=\\\"4\\\" placeholder=\\\"Ajoutez vos notes ici...\\\"></textarea> </div> <div class=\\\"section\\\"> <h3>Pièces jointes</h3> <div id=\\\"attachments-list\\\"></div> </div> <button id=\\\"save-to-crm\\\" class=\\\"submit-btn\\\"> <i class=\\\"ms-Icon ms-Icon--Save\\\"></i> Enregistrer dans le CRMA </button> </div> </div> <div id=\\\"search-page\\\" class=\\\"page\\\"> <div class=\\\"search-container\\\"> <div class=\\\"search-criteria\\\"> <div class=\\\"criteria-group\\\"> <label class=\\\"checkbox-label\\\"> <input type=\\\"checkbox\\\" id=\\\"search-email-checkbox\\\" checked=\\\"checked\\\"> Rechercher par email </label> <div class=\\\"form-group\\\" id=\\\"email-search-group\\\"> <label class=\\\"form-label\\\">Email de l'expéditeur</label> <input type=\\\"email\\\" id=\\\"search-sender-email\\\" class=\\\"form-control\\\" required> </div> </div> <div class=\\\"criteria-group\\\"> <label class=\\\"checkbox-label\\\"> <input type=\\\"checkbox\\\" id=\\\"search-phone-checkbox\\\"> Rechercher par téléphone </label> <div class=\\\"form-group phone-input-group\\\" id=\\\"phone-search-group\\\"> <label for=\\\"search-phone-number\\\">Numéro de téléphone</label> <div class=\\\"phone-input-container\\\"> <input type=\\\"text\\\" id=\\\"search-phone-number\\\" class=\\\"form-control\\\" placeholder=\\\"Entrez un numéro\\\"/> <select id=\\\"search-phone-select\\\" class=\\\"form-control\\\"> <option value=\\\"\\\">Numéros détectés</option> </select> </div> </div> </div> </div> <button id=\\\"search-contact-btn\\\" class=\\\"submit-btn\\\"> <i class=\\\"ms-Icon ms-Icon--Search\\\"></i> Chercher le contact </button> <div id=\\\"search-results\\\" class=\\\"search-results\\\"> </div> </div> </div> <div id=\\\"settings-page\\\" class=\\\"page\\\"> <div class=\\\"form-container\\\"> <div class=\\\"header\\\"> <h2>Réglages de connexion Odoo</h2> </div> <div class=\\\"form-group\\\"> <label class=\\\"form-label\\\">URL du serveur Odoo</label> <input type=\\\"text\\\" id=\\\"odoo-url\\\" class=\\\"form-control\\\" placeholder=\\\"https://votre-instance.odoo.com\\\"/> </div> <div class=\\\"form-group\\\"> <label class=\\\"form-label\\\">Base de données</label> <input type=\\\"text\\\" id=\\\"database\\\" class=\\\"form-control\\\" placeholder=\\\"nom_de_la_base\\\"/> </div> <div class=\\\"form-group\\\"> <label class=\\\"form-label\\\">Nom d'utilisateur</label> <input type=\\\"text\\\" id=\\\"username\\\" class=\\\"form-control\\\" placeholder=\\\"utilisateur@exemple.com\\\"/> </div> <div class=\\\"form-group\\\"> <label class=\\\"form-label\\\">Mot de passe</label> <div class=\\\"password-container\\\"> <input type=\\\"password\\\" id=\\\"password\\\" class=\\\"form-control\\\"/> <button type=\\\"button\\\" id=\\\"toggle-password\\\" class=\\\"toggle-password\\\"> <i class=\\\"ms-Icon ms-Icon--RedEye\\\"></i> </button> </div> </div> <div class=\\\"mb-3\\\"> <button id=\\\"test-connection\\\" class=\\\"submit-btn\\\"> <i class=\\\"ms-Icon ms-Icon--PlugConnected\\\"></i> Tester la connexion </button> </div> <div> <button id=\\\"save-settings\\\" class=\\\"submit-btn\\\"> <i class=\\\"ms-Icon ms-Icon--Save\\\"></i> Sauvegarder les réglages </button> </div> </div> </div> </div> </body></html>\";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","_regeneratorRuntime","t","r","n","defineProperty","value","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","d","getPrototypeOf","v","values","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","return","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","catch","delegateYield","asyncGeneratorStep","_asyncToGenerator","arguments","apply","_next","_throw","log","message","data","timestamp","Date","toISOString","logMessage","concat","console","group","stack","groupEnd","Office","onReady","info","host","HostType","Outlook","getElementById","style","display","_callee","_context","loadEmailData","loadUserEmailData","loadSavedSettings","setupPasswordToggle","setupFormValidation","t0","createElement","extractPhoneNumbers","text","countDigits","str","match","formatPhoneNumber","phone","cleaned","trim","startsWith","formatted","digitCount","phones","Map","_i","_phonePatterns","_step","pattern","_iterator","_createForOfIteratorHelper","matchAll","phoneInfo","has","set","err","Array","from","populatePhoneSelect","phoneSelect","phoneInput","options","remove","index","option","textContent","appendChild","createEmailEml","_createEmailEml","_callee17","item","subject","receivedTime","bodyResult","emlContent","encoder","bytes","base64","safeSubject","fileName","_context18","context","mailbox","sender","emailAddress","dateTimeCreated","reject","body","getAsync","CoercionType","Text","result","status","AsyncResultStatus","Succeeded","join","TextEncoder","encode","btoa","String","fromCharCode","datas","mimetype","displayAttachments","attachmentList","_x","_loadAttachments","loadAttachments","error","showNotification","setupPhoneInputs","addEventListener","target","extractEmails","_step2","emails","_iterator2","email","toLowerCase","isPriority","split","includes","sort","localeCompare","populateEmailSelect","emailSelect","emailInput","emailInfo","priority","_callee18","attachmentIndex","attachments","_iterator6","_step6","attachment","content","attachmentItem","attachmentData","tempDiv","images","_iterator7","_step7","img","_item","_context19","innerHTML","attachmentsToUpload","filter","isInline","contentType","getAttachmentContent","id","createImageAttachmentItem","createAttachmentItem","t1","Html","asyncContext","asyncResult","getAttribute","t2","div","className","substring","_loadEmailData","_callee19","emlAttachment","_iterator8","_step8","attachmentsList","fullText","senderEmail","senderName","_context20","updateProgress","res_model","size","t3","cleanEmail","progressDiv","cssText","head","createProgressDiv","fileProgress","querySelector","dataset","file","createFileProgress","setTimeout","attachmentId","getAttachmentContentAsync","userProfile","userEmail","savedSettings","localStorage","getItem","settings","JSON","parse","hasUrl","odooUrl","hasDatabase","database","hasUsername","username","hasPassword","password","passwordInput","toggleButton","icon","classList","OdooAPI","_classCallCheck","getSettings","db","worker_url","maxRetries","retryDelay","key","url","_retryRequest","_callee2","fn","_loop","_ret","_this","_context3","_context2","_x5","unsafe","_createLead","_callee3","emailFrom","description","userId","phoneNumber","cleanData","leadResponse","leadResponseText","leadId","checkedAttachments","_iterator4","_step4","checkbox","attachmentResponse","attachmentResult","_context4","getUserId","escapeXml","email_from","user_id","active","company_id","stage_id","contact_name","fetchWithTimeout","headers","buildHeaders","stringify","odoo_url","lead_data","success","lead_id","querySelectorAll","parseInt","attachment_data","res_id","json","attachment_id","details","_x6","_x7","_x8","_createAttachment","_callee4","finalAttachmentData","response","_context5","model","_objectSpread","resId","_x9","_getUserId","_callee5","_context6","ok","_uploadLargeAttachment","_callee6","CHUNK_SIZE","totalChunks","start","end","chunk","isLastChunk","chunkResponse","_context7","Math","ceil","totalSize","chunks","min","chunk_index","total_chunks","is_last_chunk","round","_x10","_x11","_testServerConnection","_callee8","_this2","_context9","retryRequest","_callee7","_data$details","_data$details2","errorData","versionInfo","_context8","login_response","extractVersionInfo","version_response","version","responses","handleError","_searchPartners","_callee9","searchCriteria","_context10","search_criteria","partners","_x12","xmlResponse","versionMatch","serieMatch","serie","_init","_callee10","testResult","_context11","validateCredentials","formatOdooUrl","testServerConnection","_fetchWithTimeout","_callee11","timeout","controller","_args12","_context12","AbortController","abort","fetch","signal","clearTimeout","_x13","_x14","customMessage","notification","messageEl","opportunityLink","detailsEl","errorMessage","logs","logsEl","logEntry","stackEl","switchPage","pageId","mainPage","settingsPage","searchPage","add","requiredFields","saveButton","validateForm","isValid","every","fieldId","field","disabled","onclick","_callee12","button","odoo","serverTest","_context13","setItem","_callee13","_context14","_callee15","resultsContainer","emailChecked","phoneChecked","cardsContainer","_context16","checked","searchPartners","partner","card","street","zip","city","closest","_callee14","partnerId","originalText","_odoo","_iterator5","_step5","_context15","createAttachment","_callee16","emailBody","additionalNotes","_context17","map","line","createLead","URL"],"sourceRoot":""}