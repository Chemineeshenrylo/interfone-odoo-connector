{"version":3,"file":"commands.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/./src/commands/commands.js"],"sourcesContent":["/* global Office */\n\nclass OdooAPI {\n  constructor() {\n      const settings = this.getSettings();\n      this.host = settings.odooUrl;\n      this.db = settings.database;\n      this.username = settings.username;\n      this.password = settings.password;\n      this.worker_url = 'https://royal-pond-be25.lvr-3b7.workers.dev';\n  }\n\n  getSettings() {\n      const savedSettings = localStorage.getItem('odooSettings');\n      if (!savedSettings) {\n          throw new Error('Aucun réglage trouvé. Veuillez configurer l\\'add-in.');\n      }\n      return JSON.parse(savedSettings);\n  }\n\n  buildHeaders() {\n      return {\n          'Content-Type': 'application/json',\n          'X-Api-Key': this.password\n      };\n  }\n\n  async searchPartners(searchCriteria) {\n      try {\n          const response = await fetch(`${this.worker_url}/search_partners`, {\n              method: 'POST',\n              headers: this.buildHeaders(),\n              body: JSON.stringify({\n                  odoo_url: this.host,\n                  database: this.db,\n                  username: this.username,\n                  password: this.password,\n                  search_criteria: searchCriteria\n              })\n          });\n\n          const data = await response.json();\n          if (!data.success) {\n              throw new Error(data.error || 'Échec de la recherche');\n          }\n\n          return data.partners;\n      } catch (error) {\n          console.error('Erreur recherche:', error);\n          throw error;\n      }\n  }\n\n  async createAttachment(attachmentData) {\n      try {\n          const response = await fetch(`${this.worker_url}/create_attachment`, {\n              method: 'POST',\n              headers: this.buildHeaders(),\n              body: JSON.stringify({\n                  odoo_url: this.host,\n                  database: this.db,\n                  username: this.username,\n                  password: this.password,\n                  attachment_data: attachmentData\n              })\n          });\n\n          const data = await response.json();\n          if (!data.success) {\n              throw new Error(data.error || 'Échec création pièce jointe');\n          }\n\n          return data;\n      } catch (error) {\n          console.error('Erreur création pièce jointe:', error);\n          throw error;\n      }\n  }\n}\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Outlook) {\n      initializePage();\n  }\n});\n\nfunction showNotification(message, type = 'info') {\n  const div = document.createElement('div');\n  div.className = `notification ${type}`;\n  div.textContent = message;\n  div.style.cssText = `\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      padding: 15px;\n      background: white;\n      border-radius: 4px;\n      box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n      z-index: 1000;\n      border-left: 4px solid ${type === 'error' ? '#f44336' : '#4CAF50'};\n  `;\n  document.body.appendChild(div);\n  setTimeout(() => div.remove(), 5000);\n}\n\nasync function initializePage() {\n  try {\n      await loadEmailData();\n      setupEventListeners();\n  } catch (error) {\n      console.error('Erreur initialisation:', error);\n      showNotification('Erreur lors de l\\'initialisation', 'error');\n  }\n}\n\nconst style = document.createElement('style');\nstyle.textContent = `\n    .partner-cards {\n        display: grid;\n        gap: 1rem;\n    }\n    \n    .partner-card {\n        border: 1px solid #ddd;\n        border-radius: 4px;\n        background: white;\n    }\n\n    .card-header {\n        display: flex;\n        align-items: center;\n        gap: 1rem;\n        margin-bottom: 0.5rem;\n    }\n\n    .partner-name {\n        margin: 0;\n        font-size: 1.1em;\n        font-weight: 600;\n    }\n\n    .card-content {\n        color: #666;\n        font-size: 0.9em;\n    }\n\n    .card-footer {\n        display: flex;\n        justify-content: space-between;\n        margin-top: 1rem;\n    }\n\n    .view-button, .upload-button {\n        padding: 0.5rem 1rem;\n        border-radius: 4px;\n        border: none;\n        cursor: pointer;\n        text-decoration: none;\n        color: white;\n        background: #007bff;\n    }\n\n    .upload-button {\n        background: #28a745;\n    }\n\n    .notification {\n        position: fixed;\n        top: 20px;\n        right: 20px;\n        padding: 1rem;\n        border-radius: 4px;\n        background: white;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        z-index: 1000;\n    }\n`;\ndocument.head.appendChild(style);\n\n\n\nasync function loadEmailData() {\n  const item = Office.context.mailbox.item;\n  if (!item) return;\n\n  try {\n    if (item.sender) {\n      let senderEmail = item.sender.emailAddress;\n      let senderName = item.sender.displayName;\n  \n      senderEmail = cleanEmail(senderEmail);\n      senderName = senderName || senderEmail.split('@')[0];\n  \n      // Pré-remplir le champ nom et email dans la page de recherche\n      const searchNameInput = document.getElementById('search-name');\n      const searchEmailInput = document.getElementById('search-sender-email');\n      const nameRadio = document.getElementById('search-name-radio');\n      \n      if (searchNameInput) {\n          searchNameInput.value = senderName;\n          searchNameInput.disabled = false; // Activer le champ nom\n      }\n      if (searchEmailInput) {\n          searchEmailInput.value = senderEmail;\n          searchEmailInput.disabled = true; // Désactiver le champ email initialement\n      }\n      if (nameRadio) {\n          nameRadio.checked = true; // S'assurer que le radio nom est coché\n      }\n\n      // Activer le bouton de recherche initialement\n      const searchBtn = document.getElementById('search-contact-btn');\n      if (searchBtn) {\n          searchBtn.disabled = false;\n      }\n    }\n\n    // Chargement des pièces jointes\n    if (item.attachments) {\n        window.attachmentsToUpload = await Promise.all(\n            item.attachments\n                .filter(a => !a.isInline)\n                .map(async (attachment) => {\n                    const content = await getAttachmentContent(attachment.id);\n                    return {\n                        name: attachment.name,\n                        datas: content,\n                        mimetype: attachment.contentType || 'application/octet-stream',\n                        type: 'binary'\n                    };\n                })\n        );\n    }\n\n    const result = await new Promise((resolve, reject) => {\n        item.body.getAsync(Office.CoercionType.Text, (result) => {\n            if (result.status === Office.AsyncResultStatus.Succeeded) {\n                resolve(result.value);\n            } else {\n                reject(new Error('Échec chargement message'));\n            }\n        });\n    });\n\n    // Extraction et configuration des numéros de téléphone\n    const phones = extractPhoneNumbers(result);\n    const phoneInput = document.getElementById('search-phone-number');\n    const phoneSelect = document.getElementById('search-phone-select');\n    \n    if (phoneInput) {\n        phoneInput.disabled = true; // Désactiver le champ téléphone initialement\n    }\n    if (phoneSelect) {\n        phoneSelect.disabled = true; // Désactiver le select téléphone initialement\n    }\n    \n    populatePhoneSelect(phones);\n\n  } catch (error) {\n      console.error('Erreur chargement données:', error);\n      showNotification('Erreur lors du chargement des données', 'error');\n      throw error;\n  }\n}\n\nfunction cleanEmail(email) {\n  return email.replace(/<mailto:|>/g, '').trim().split(' ')[0];\n}\n\nfunction extractPhoneNumbers(text) {\n    function countDigits(str) {\n        return (str.match(/\\d/g) || []).length;\n    }\n\n    const phonePatterns = [\n        // Format international avec + ou 00\n        /(?:\\+|00)[1-9]\\d{1,3}[- .]?\\d(?:[- .]?\\d){4,14}/g,\n        // Format belge spécifique\n        /(?:0[1-9]|04\\d{1,2})[/\\s.-]?\\d{2,3}[/\\s.-]?\\d{2,3}[/\\s.-]?\\d{2,3}/g,\n        // Format avec séparateurs variés\n        /\\d{3,4}[/\\s.-]?\\d{2,3}[/\\s.-]?\\d{2,3}[/\\s.-]?\\d{2,3}/g\n    ];\n\n    function formatPhoneNumber(phone) {\n        if (countDigits(phone) < 6) {\n            return null;\n        }\n\n        // Nettoyer le numéro\n        let cleaned = phone.trim()\n            .replace(/[\\(\\)]/g, '') // Enlever les parenthèses\n            .replace(/[\\/\\s.-]+/g, ' ') // Normaliser les séparateurs en espaces\n            .replace(/\\s+/g, ' ')  // Normaliser les espaces multiples\n            .trim();\n\n        // Formatter les numéros belges\n        if (cleaned.startsWith('0')) {\n            // Convertir les numéros commençant par 0 en format international\n            cleaned = '+32' + cleaned.substring(1);\n        } else if (cleaned.startsWith('00')) {\n            cleaned = '+' + cleaned.substring(2);\n        }\n\n        return {\n            formatted: cleaned,\n            digitCount: countDigits(cleaned)\n        };\n    }\n\n    let phones = new Map();\n\n    for (let pattern of phonePatterns) {\n        const matches = text.matchAll(pattern);\n        for (const match of matches) {\n            const phoneInfo = formatPhoneNumber(match[0]);\n            if (phoneInfo && phoneInfo.digitCount >= 6) {\n                if (!phones.has(phoneInfo.formatted)) {\n                    phones.set(phoneInfo.formatted, phoneInfo);\n                }\n            }\n        }\n    }\n\n    return Array.from(phones.values());\n}\n\nfunction populatePhoneSelect(phones) {\n  const phoneSelect = document.getElementById('search-phone-select');\n  const phoneInput = document.getElementById('search-phone-number');\n  \n  while (phoneSelect.options.length > 1) {\n      phoneSelect.remove(1);\n  }\n\n  phones.forEach((phoneInfo, index) => {\n      const option = document.createElement('option');\n      option.value = phoneInfo.formatted;\n      option.textContent = `Numéro ${index + 1}: ${phoneInfo.formatted}`;\n      phoneSelect.appendChild(option);\n  });\n\n  if (phones.length > 0) {\n      phoneInput.value = phones[0].formatted;\n  }\n}\n\nfunction getAttachmentContent(attachmentId) {\n  return new Promise((resolve, reject) => {\n      Office.context.mailbox.item.getAttachmentContentAsync(attachmentId, (result) => {\n          if (result.status === Office.AsyncResultStatus.Succeeded) {\n              resolve(result.value.content);\n          } else {\n              reject(new Error('Échec récupération pièce jointe'));\n          }\n      });\n  });\n}\n\nfunction setupEventListeners() {\n  // Gestion des radio buttons\n  const radioButtons = document.querySelectorAll('input[name=\"search-type\"]');\n  const searchBtn = document.getElementById('search-contact-btn');\n\n  // S'assurer que les éléments existent\n  if (!searchBtn) {\n      console.error('Bouton de recherche non trouvé');\n      return;\n  }\n\n  radioButtons.forEach(radio => {\n      radio.addEventListener('change', function() {\n          // Désactiver tous les champs\n          document.getElementById('search-name').disabled = true;\n          document.getElementById('search-sender-email').disabled = true;\n          document.getElementById('search-phone-number').disabled = true;\n          document.getElementById('search-phone-select').disabled = true;\n\n          // Activer le champ correspondant au radio sélectionné\n          switch(this.value) {\n              case 'name':\n                  document.getElementById('search-name').disabled = false;\n                  break;\n              case 'email':\n                  document.getElementById('search-sender-email').disabled = false;\n                  break;\n              case 'phone':\n                  document.getElementById('search-phone-number').disabled = false;\n                  document.getElementById('search-phone-select').disabled = false;\n                  break;\n          }\n      });\n  });\n\n  // Gestion du select de téléphone\n  const phoneSelect = document.getElementById('search-phone-select');\n  if (phoneSelect) {\n      phoneSelect.addEventListener('change', (e) => {\n          const phoneInput = document.getElementById('search-phone-number');\n          if (phoneInput && e.target.value) {\n              phoneInput.value = e.target.value;\n          }\n      });\n  }\n\n  if (searchBtn) {\n      searchBtn.addEventListener('click', handleSearch);\n  }\n}\n\n\n\nasync function handleSearch() {\n  const button = document.getElementById('search-contact-btn');\n  const resultsContainer = document.getElementById('search-results');\n  \n  try {\n      button.disabled = true;\n      button.innerHTML = '<i class=\"ms-Icon ms-Icon--Search\"></i>Recherche en cours...';\n\n      const criteria = buildSearchCriteria();\n      if (!criteria) {\n          showNotification('Veuillez sélectionner au moins un critère de recherche', 'error');\n          return;\n      }\n\n      const odoo = new OdooAPI();\n      const partners = await odoo.searchPartners(criteria);\n      displayResults(partners, odoo.host);\n\n  } catch (error) {\n      console.error('Erreur recherche:', error);\n      showNotification(error.message, 'error');\n  } finally {\n      button.disabled = false;\n      button.innerHTML = '<i class=\"ms-Icon ms-Icon--Search\"></i>Chercher le contact';\n  }\n}\n\nfunction buildSearchCriteria() {\n  const selectedType = document.querySelector('input[name=\"search-type\"]:checked');\n  if (!selectedType) return null;\n\n  const criteria = {};\n  \n  // Correction de la logique pour obtenir l'ID du champ\n  let fieldId;\n  switch(selectedType.value) {\n      case 'phone':\n          fieldId = 'search-phone-number';\n          break;\n      case 'email':\n          fieldId = 'search-sender-email';  // ID correct pour l'email\n          break;\n      case 'name':\n          fieldId = 'search-name';\n          break;\n      default:\n          return null;\n  }\n\n  const inputField = document.getElementById(fieldId);\n  if (!inputField) {\n      console.error(`Champ ${fieldId} non trouvé`);\n      return null;\n  }\n\n  const value = inputField.value.trim();\n  \n  if (value) {\n      if (selectedType.value === 'phone') {\n          criteria.phone = value.replace(/[^0-9+]/g, '');\n      } else {\n          criteria[selectedType.value] = value;\n      }\n  }\n\n  return Object.keys(criteria).length > 0 ? criteria : null;\n}\nfunction displayResults(partners, odooHost) {\n  const container = document.getElementById('search-results');\n  container.innerHTML = '';\n\n  if (partners.length === 0) {\n      container.innerHTML = '<div class=\"no-results\">Aucun contact trouvé</div>';\n      return;\n  }\n\n  const cardsContainer = document.createElement('div');\n  cardsContainer.className = 'partner-cards';\n\n  partners.forEach(partner => {\n      const card = createPartnerCard(partner, odooHost);\n      cardsContainer.appendChild(card);\n  });\n\n  container.appendChild(cardsContainer);\n  setupCardListeners();\n}\n\nfunction createPartnerCard(partner, odooHost) {\n  const card = document.createElement('div');\n  card.className = 'partner-card';\n  card.dataset.partnerId = partner.id;\n  card.innerHTML = `\n      <div class=\"card-header\">\n          <input type=\"radio\" name=\"partner-select\" class=\"partner-select\" data-partner-id=\"${partner.id}\">\n          <h3 class=\"partner-name\">${partner.name}</h3>\n      </div>\n      <div class=\"card-content\">\n          <p class=\"partner-street\">${partner.street || ''}</p>\n          <p class=\"partner-city\">${partner.zip || ''} ${partner.city || ''}</p>\n      </div>\n      <div class=\"card-footer\">\n          <a href=\"${odooHost}/web#id=${partner.id}&model=res.partner&view_type=form\" \n             target=\"_blank\" class=\"view-button\">\n             Voir dans Odoo\n          </a>\n          <button class=\"upload-button\" style=\"display: none;\" data-partner-id=\"${partner.id}\">\n              <i class=\"ms-Icon ms-Icon--Upload\"></i> Upload sélection\n          </button>\n      </div>\n      <div class=\"attachment-section\" style=\"display: none;\">\n          <h4>Pièces jointes disponibles</h4>\n          <div class=\"attachment-list\"></div>\n      </div>\n  `;\n  return card;\n}\n\nasync function loadAttachments(attachmentList) {\n  attachmentList.innerHTML = '';\n  console.log('Début du chargement des pièces jointes');\n  \n  const item = Office.context.mailbox.item;\n  \n  // Réinitialiser le tableau des pièces jointes\n  window.attachmentsToUpload = [];\n  let attachmentIndex = 0;\n\n  // Charger toutes les pièces jointes, y compris les inline\n  if (item.attachments) {\n      // Filtrer et traiter les pièces jointes\n      const attachments = item.attachments.filter(attachment => {\n          // Garder les pièces jointes normales et les images inline\n          return !attachment.isInline || \n                 (attachment.contentType && attachment.contentType.startsWith('image/'));\n      });\n\n      // Charger le contenu de chaque pièce jointe\n      for (const attachment of attachments) {\n          try {\n              const content = await getAttachmentContent(attachment.id);\n              let attachmentItem;\n\n              if (attachment.isInline && attachment.contentType.startsWith('image/')) {\n                  // Créer un item pour une image inline\n                  attachmentItem = createImageAttachmentItem(\n                      `data:${attachment.contentType};base64,${content}`,\n                      attachmentIndex,\n                      attachment.name\n                  );\n                  \n                  // Stocker l'image inline\n                  window.attachmentsToUpload[attachmentIndex] = {\n                      name: attachment.name,\n                      datas: content,\n                      mimetype: attachment.contentType,\n                      type: 'binary',\n                      isInline: true\n                  };\n              } else {\n                  // Créer un item pour une pièce jointe normale\n                  const attachmentData = {\n                      name: attachment.name,\n                      datas: content,\n                      mimetype: attachment.contentType || 'application/octet-stream',\n                      type: 'binary'\n                  };\n                  attachmentItem = createAttachmentItem(attachmentData, attachmentIndex);\n                  \n                  // Stocker la pièce jointe normale\n                  window.attachmentsToUpload[attachmentIndex] = attachmentData;\n              }\n\n              attachmentList.appendChild(attachmentItem);\n              attachmentIndex++;\n\n          } catch (error) {\n              console.error(`Erreur chargement pièce jointe ${attachment.name}:`, error);\n          }\n      }\n  }\n\n  // Essayer de récupérer les images du corps du mail\n  try {\n      const body = await new Promise((resolve, reject) => {\n          item.body.getAsync(\n              Office.CoercionType.Html,\n              { asyncContext: \"This is passed to the callback\" },\n              function (asyncResult) {\n                  if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {\n                      resolve(asyncResult.value);\n                  } else {\n                      reject(new Error('Échec chargement HTML'));\n                  }\n              }\n          );\n      });\n\n      const tempDiv = document.createElement('div');\n      tempDiv.innerHTML = body;\n\n      // Chercher les images qui ne sont pas des CID\n      const images = Array.from(tempDiv.getElementsByTagName('img'))\n          .filter(img => {\n              const src = img.src || img.getAttribute('src');\n              return src && \n                     !src.startsWith('cid:') && \n                     !src.startsWith('data:') && \n                     !src.includes('outlook.office365.com') && \n                     !src.includes('outlook.office.com');\n          });\n\n      // Ajouter les images trouvées\n      for (const img of images) {\n          const src = img.src || img.getAttribute('src');\n          if (src) {\n              const item = createImageAttachmentItem(\n                  src, \n                  attachmentIndex,\n                  `Image ${attachmentIndex + 1}`\n              );\n              attachmentList.appendChild(item);\n              \n              // Stocker l'URL de l'image pour l'upload ultérieur\n              window.attachmentsToUpload[attachmentIndex] = {\n                  name: `Image ${attachmentIndex + 1}.png`,\n                  src: src,\n                  type: 'image',\n                  mimetype: 'image/png'\n              };\n              \n              attachmentIndex++;\n          }\n      }\n\n  } catch (error) {\n      console.error('Erreur chargement images:', error);\n  }\n}\n\n// Modifier la fonction createImageAttachmentItem pour accepter un nom\nfunction createImageAttachmentItem(src, index, name = null) {\n  const div = document.createElement('div');\n  div.className = 'attachment-item';\n  \n  const displayName = name || `Image ${index + 1}`;\n  \n  div.innerHTML = `\n      <input type=\"checkbox\" id=\"image-${index}\" data-type=\"image\" data-src=\"${src}\">\n      <img src=\"${src}\" class=\"image-preview\" alt=\"Preview\" onerror=\"this.style.display='none'\">\n      <label for=\"image-${index}\">\n          ${displayName}\n          <br>\n          <small class=\"image-source\">${src.startsWith('data:') ? 'Image intégrée' : src.substring(0, 50) + '...'}</small>\n      </label>\n  `;\n\n  return div;\n}\n\nfunction createAttachmentItem(attachment, index) {\n  const div = document.createElement('div');\n  div.className = 'attachment-item';\n  \n  // Ajouter des styles spécifiques pour les pièces jointes\n  const styles = document.createElement('style');\n  styles.textContent = `\n      .attachment-item {\n          display: flex;\n          align-items: center;\n          padding: 10px;\n          border: 1px solid #ddd;\n          margin-bottom: 5px;\n          border-radius: 4px;\n      }\n      .attachment-item:hover {\n          background-color: #f5f5f5;\n      }\n      .file-type {\n          color: #666;\n          font-size: 0.8em;\n          margin-left: 5px;\n      }\n      .attachment-item label {\n          cursor: pointer;\n          flex: 1;\n      }\n      .attachment-item input[type=\"checkbox\"] {\n          margin-right: 10px;\n      }\n  `;\n  document.head.appendChild(styles);\n\n  div.innerHTML = `\n      <input type=\"checkbox\" id=\"attachment-${index}\" data-type=\"file\">\n      <label for=\"attachment-${index}\">\n          ${attachment.name}\n          <span class=\"file-type\">(${attachment.mimetype})</span>\n      </label>\n  `;\n\n  return div;\n}\n\n\n\n\nfunction setupCardListeners() {\n    // Gestion des radios\n    document.querySelectorAll('.partner-select').forEach(radio => {\n        radio.addEventListener('change', async function() {\n            const selectedCard = this.closest('.partner-card');\n            const partnerId = this.dataset.partnerId;\n            \n            if (this.checked) {\n                // Si la carte est sélectionnée\n                // Cacher les autres cartes\n                document.querySelectorAll('.partner-card').forEach(card => {\n                    if (card !== selectedCard) {\n                        card.style.display = 'none';\n                    }\n                });\n\n                // Afficher la section des pièces jointes\n                const attachmentSection = selectedCard.querySelector('.attachment-section');\n                const attachmentList = selectedCard.querySelector('.attachment-list');\n                const uploadButton = selectedCard.querySelector('.upload-button');\n                \n                attachmentSection.style.display = 'block';\n                uploadButton.style.display = 'block';\n                \n                // Charger les pièces jointes\n                await loadAttachments(attachmentList);\n            } else {\n                // Si la carte est désélectionnée\n                // Réafficher toutes les cartes\n                document.querySelectorAll('.partner-card').forEach(card => {\n                    card.style.display = 'block';\n                });\n\n                // Cacher la section des pièces jointes et le bouton d'upload\n                const attachmentSection = selectedCard.querySelector('.attachment-section');\n                const uploadButton = selectedCard.querySelector('.upload-button');\n                \n                attachmentSection.style.display = 'none';\n                uploadButton.style.display = 'none';\n            }\n        });\n\n        // Permettre la désélection en cliquant à nouveau sur le radio\n        radio.addEventListener('click', function(e) {\n            if (this.checked && this.dataset.wasChecked === 'true') {\n                this.checked = false;\n                this.dispatchEvent(new Event('change'));\n            }\n            this.dataset.wasChecked = this.checked;\n        });\n    });\n\n    // Gestion des boutons d'upload\n    document.querySelectorAll('.upload-button').forEach(button => {\n        button.addEventListener('click', handleUpload);\n    });\n}\n\nasync function handleUpload() {\n  const partnerId = this.dataset.partnerId;\n  const originalText = this.innerHTML;\n  const card = this.closest('.partner-card');\n  \n  try {\n      this.disabled = true;\n      this.innerHTML = '<i class=\"ms-Icon ms-Icon--Sync\"></i> Upload en cours...';\n      \n      const selectedAttachments = card.querySelectorAll('.attachment-item input[type=\"checkbox\"]:checked');\n      \n      if (selectedAttachments.length === 0) {\n          showNotification('Veuillez sélectionner au moins une pièce jointe', 'error');\n          return;\n      }\n      \n      const odoo = new OdooAPI();\n      \n      for (const checkbox of selectedAttachments) {\n          const id = parseInt(checkbox.id.split('-')[1]);\n          const storedAttachment = window.attachmentsToUpload[id];\n          \n          if (!storedAttachment) {\n              console.error(`Pièce jointe non trouvée pour l'index ${id}`);\n              continue;\n          }\n\n          let attachmentData;\n          \n          if (storedAttachment.type === 'image' && storedAttachment.src) {\n              // Image du corps du mail\n              const datas = await fetchImageAsBase64(storedAttachment.src);\n              attachmentData = {\n                  name: storedAttachment.name,\n                  datas: datas,\n                  mimetype: storedAttachment.mimetype,\n                  type: 'binary',\n                  res_model: 'res.partner',\n                  res_id: parseInt(partnerId)\n              };\n          } else {\n              // Pièce jointe normale ou image inline\n              attachmentData = {\n                  ...storedAttachment,\n                  res_model: 'res.partner',\n                  res_id: parseInt(partnerId)\n              };\n          }\n          \n          await odoo.createAttachment(attachmentData);\n      }\n      \n      showNotification('Pièces jointes uploadées avec succès', 'success');\n      \n      // Reset\n      card.querySelector('.partner-select').checked = false;\n      card.querySelector('.attachment-section').style.display = 'none';\n      this.style.display = 'none';\n      document.querySelectorAll('.partner-card').forEach(c => {\n          c.style.display = 'block';\n      });\n      \n  } catch (error) {\n      console.error('Erreur upload:', error);\n      showNotification('Erreur lors de l\\'upload des pièces jointes', 'error');\n  } finally {\n      this.disabled = false;\n      this.innerHTML = originalText;\n  }\n}\n\n// Fonction utilitaire pour convertir une image en base64\nasync function fetchImageAsBase64(url) {\n  const response = await fetch(url);\n  const blob = await response.blob();\n  return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onloadend = () => resolve(reader.result.split(',')[1]);\n      reader.onerror = reject;\n      reader.readAsDataURL(blob);\n  });\n}"],"names":["_regeneratorRuntime","e","t","r","Object","prototype","n","hasOwnProperty","o","defineProperty","value","i","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","call","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","p","d","getPrototypeOf","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","Error","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","return","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","length","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","slice","stop","rval","handle","complete","finish","catch","delegateYield","asyncGeneratorStep","_asyncToGenerator","arguments","apply","_next","_throw","_defineProperties","_toPropertyKey","key","toPrimitive","String","_toPrimitive","OdooAPI","_classCallCheck","settings","this","getSettings","host","odooUrl","db","database","username","password","worker_url","savedSettings","localStorage","getItem","JSON","parse","_searchPartners","_callee","searchCriteria","response","data","_context","fetch","concat","headers","buildHeaders","body","stringify","odoo_url","search_criteria","json","success","error","partners","t0","console","_x","_createAttachment","_callee2","attachmentData","_context2","attachment_data","_x2","showNotification","message","undefined","div","document","createElement","className","textContent","style","cssText","appendChild","setTimeout","remove","_initializePage","_callee4","_context4","loadEmailData","setupEventListeners","Office","onReady","info","HostType","Outlook","initializePage","_loadEmailData","_callee6","item","senderEmail","senderName","searchNameInput","searchEmailInput","nameRadio","searchBtn","result","phones","phoneInput","phoneSelect","_context6","context","mailbox","sender","emailAddress","replace","trim","split","getElementById","disabled","checked","attachments","all","filter","isInline","map","_ref2","_callee5","attachment","content","_context5","getAttachmentContent","id","datas","mimetype","contentType","_x5","window","attachmentsToUpload","reject","getAsync","CoercionType","Text","status","AsyncResultStatus","Succeeded","extractPhoneNumbers","populatePhoneSelect","text","countDigits","str","match","formatPhoneNumber","phone","cleaned","startsWith","substring","formatted","digitCount","Map","_i","_phonePatterns","_step","pattern","_iterator","_createForOfIteratorHelper","matchAll","phoneInfo","has","set","err","Array","from","options","index","option","attachmentId","getAttachmentContentAsync","radioButtons","querySelectorAll","radio","addEventListener","target","handleSearch","_handleSearch","_callee7","button","criteria","odoo","_context7","innerHTML","buildSearchCriteria","searchPartners","displayResults","selectedType","querySelector","fieldId","inputField","odooHost","container","cardsContainer","partner","card","dataset","partnerId","street","zip","city","createPartnerCard","_callee3","selectedCard","attachmentSection","attachmentList","uploadButton","_attachmentSection","_uploadButton","_context3","closest","display","loadAttachments","wasChecked","dispatchEvent","Event","handleUpload","_x3","_loadAttachments","_callee8","attachmentIndex","_iterator2","_step2","attachmentItem","tempDiv","images","_iterator3","_step3","img","src","_item","_context8","log","createImageAttachmentItem","createAttachmentItem","t1","Html","asyncContext","asyncResult","getElementsByTagName","getAttribute","includes","t2","styles","head","_handleUpload","_callee9","originalText","selectedAttachments","_iterator4","_step4","checkbox","storedAttachment","_context9","parseInt","fetchImageAsBase64","res_model","res_id","_objectSpread","createAttachment","_x4","_fetchImageAsBase","_callee10","url","blob","_context10","reader","FileReader","onloadend","onerror","readAsDataURL"],"sourceRoot":""}